<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="bemeyer@alaska.edu" />


<title>create_size_input</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">EPSCoR SCTC Aquatic Ecology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About Me</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">create_size_input</h1>
<h4 class="author"><em><a href="mailto:bemeyer@alaska.edu">bemeyer@alaska.edu</a></em></h4>
<h4 class="date"><em>2/1/2018&quot;</em></h4>

</div>


<hr />
<div id="section" class="section level1">
<h1></h1>
<div id="epscor-sctc-aquatic-ecology" class="section level2">
<h2>EPSCoR SCTC Aquatic Ecology</h2>
<div id="juvenile-salmon-size-and-growth-data---analysis-in-progress" class="section level5">
<h5>Juvenile salmon size and growth data - Analysis in progress</h5>
<p><br></p>
<p><strong>Purpose:</strong> The purpose of this document is to explore the feasability of modeling and comparing growth rates using length/weight-at-age data collected throughout the summer seasons of 2015 and 2016.</p>
<p><strong>Hypothesis:</strong> Differential growth rates for juvenile Coho and Chinook salmon can be observed among Beaver Creek, Russian River, Ptarmigan Creek, and Mainstem Kenai River using size-at-age data.</p>
<p>If the data allows, the observed growth rates will be used to provide size inputs (weight) for bioenergetic simulations in upcoming analyses.</p>
</div>
<div id="questions-to-consider" class="section level5">
<h5>Questions to consider:</h5>
<ul>
<li>Are statistically significant growth trends observed in size-at-age data for:
<ul>
<li>Fork Length</li>
<li>Weight</li>
</ul></li>
<li>Are the trends significant for:
<ul>
<li>Both Chinook and/or Coho?</li>
<li>2015 and/or 2016? (Or, can data from both years be combined?)</li>
</ul></li>
<li>Are the seasonal extents appropriate lengths? Is there a different way organize &amp; present temporal progression of group charcteristics like length and weight?</li>
</ul>
<hr />
<hr />
</div>
<div id="when-and-where-did-fish-sampling-occur" class="section level3">
<h3>When and where did fish sampling occur?</h3>
<p>Fish sampling effort consisted of monthly site visits in summer 2015 and 2016 to lower, middle, and upper reaches of each study drainage (with the exception of the Kenai River, which had only lower and middle sites) (Figure X, below).</p>
<pre class="r"><code># NOTE 1/22/18: this code also exists as a script at &quot;/Users/bmeyer/Google Drive/Thesis/R Analysis/Thesis Analyses R Project/Overall_scripts_2015_2016/sampling_periods.R&quot;.  Attempted to just source(&quot;\path&quot;) this script in to the markdown document but, &#39;source&#39; prevents knitting for some reason.  

############
#
# 2015
#
###########

# Verify that sheet is present, create object of sheet with all tabs
SCTC2015 &lt;- gs_title(&quot;2015 EPSCoR SCTC.xlsx&quot;)

#read in specific worksheet containing fishing data
effort2015 &lt;- SCTC2015 %&gt;% 
  gs_read(ws = &quot;B Fishing Data&quot;,col_names=TRUE, skip=2) %&gt;%
  #rename needed columns  
  rename(site.id=Site_ID,
         sample.event=Sample_Event) %&gt;%
  
  #select desired columns
  select(site.id,River,sample.event,sample.event.num,deploy_dt,collect_dt) %&gt;%
  
  #filter our blanks
  filter(!is.na(sample.event)) %&gt;%
  
  # transform columns to desired classes
  transform(site.id=as.factor(site.id),
            sample.event=as.factor(sample.event),
            sample.event.num=as.factor(sample.event.num)) </code></pre>
<pre><code>## 
Downloading: 1.4 kB     
Downloading: 1.4 kB     
Downloading: 2.8 kB     
Downloading: 2.8 kB     
Downloading: 4.1 kB     
Downloading: 4.1 kB     
Downloading: 5.1 kB     
Downloading: 5.1 kB     
Downloading: 6.5 kB     
Downloading: 6.5 kB     
Downloading: 7.2 kB     
Downloading: 7.2 kB     
Downloading: 8.5 kB     
Downloading: 8.5 kB     
Downloading: 9.5 kB     
Downloading: 9.5 kB     
Downloading: 11 kB     
Downloading: 11 kB     
Downloading: 12 kB     
Downloading: 12 kB     
Downloading: 13 kB     
Downloading: 13 kB     
Downloading: 14 kB     
Downloading: 14 kB     
Downloading: 15 kB     
Downloading: 15 kB     
Downloading: 16 kB     
Downloading: 16 kB     
Downloading: 16 kB     
Downloading: 16 kB     
Downloading: 16 kB     
Downloading: 16 kB     
Downloading: 16 kB     
Downloading: 16 kB</code></pre>
<pre class="r"><code>###################
#
# 2016
#
###################

# Verify that sheet is present, create object of sheet with all tabs
SCTC2016 &lt;- gs_title(&quot;2016_EPSCoR_Aquatic_Ecology_Database&quot;)

#read in specific worksheet containing fishing data
effort2016 &lt;- SCTC2016 %&gt;% 
  gs_read(ws = &quot;B Fishing Data&quot;,col_names=TRUE, skip=2) %&gt;%
  
  #rename needed columns  
  rename(site.id=Site_ID,
         sample.event=Sample_Event) %&gt;%
  
  #select desired columns
  select(site.id,River,sample.event,sample.event.num,deploy_dt,collect_dt) %&gt;%
  
  #filter our blanks
  filter(!is.na(sample.event)) %&gt;%
  
  # transform columns to desired classes
  transform(site.id=as.factor(site.id),
            sample.event=as.factor(sample.event),
            sample.event.num=as.factor(sample.event.num)) </code></pre>
<pre><code>## 
Downloading: 1.2 kB     
Downloading: 1.2 kB     
Downloading: 2.5 kB     
Downloading: 2.5 kB     
Downloading: 3.9 kB     
Downloading: 3.9 kB     
Downloading: 4.1 kB     
Downloading: 4.1 kB     
Downloading: 4.9 kB     
Downloading: 4.9 kB     
Downloading: 6 kB     
Downloading: 6 kB     
Downloading: 6.9 kB     
Downloading: 6.9 kB     
Downloading: 8.1 kB     
Downloading: 8.1 kB     
Downloading: 9 kB     
Downloading: 9 kB     
Downloading: 10 kB     
Downloading: 10 kB     
Downloading: 11 kB     
Downloading: 11 kB     
Downloading: 12 kB     
Downloading: 12 kB     
Downloading: 13 kB     
Downloading: 13 kB     
Downloading: 14 kB     
Downloading: 14 kB     
Downloading: 15 kB     
Downloading: 15 kB     
Downloading: 17 kB     
Downloading: 17 kB     
Downloading: 17 kB     
Downloading: 17 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB</code></pre>
<pre class="r"><code># bind 2015 &amp; 2016 data; format datetimes
effort &lt;- bind_rows(effort2015,effort2016) %&gt;%
  transform(collect_dt = anytime(collect_dt),
            deploy_dt = anytime(deploy_dt)) %&gt;%
  mutate(year = year(collect_dt)) 


###########################
# Define Temporal Extents #
###########################

# &quot;Sample Event&quot; temporal extent

# find earliest deployment time and latest collection time for each sampling event.
# sampling events are typically fall within 24 hours (~99% of the time) with a few exceptions.
# calculate start and finish of each sampling event
sample_events &lt;- effort %&gt;%
  group_by(sample.event,River, sample.event.num,year) %&gt;%
  summarise(event.start = min(deploy_dt),
            event.end = max(collect_dt)) %&gt;%
  mutate(hours = as.numeric(difftime(event.end,event.start,unit=&quot;hours&quot;)),
         doy =yday(event.start)) 


# &quot;Season&quot; temporal extent

# find earliest deployment date and latest collection date for each &#39;sample.event.num&#39; by River and year
# to determine temporal extent for each season 
seasons &lt;- effort %&gt;%
  group_by(sample.event.num,River,year) %&gt;% 
  summarize(season.start = min(deploy_dt),
            season.end = max(collect_dt)) %&gt;%
  mutate(season = fct_recode(as.factor(sample.event.num), 
                             &quot;Early Summer&quot;=&quot;1&quot;, 
                             &quot;Mid-Summer&quot; = &quot;2&quot;,
                             &quot;Late Summer&quot; =&quot;3&quot;,
                             &quot;Fall&quot; = &quot;4&quot;)) %&gt;%
  mutate(days = as.numeric(difftime(season.end,season.start,unit=&quot;days&quot;))) 

# join &quot;seasons&quot; to &quot;sample_events&quot; to show which sampling events occurred in which seasons
effort_fnl &lt;- left_join(sample_events,seasons,by = c(&quot;River&quot;,&quot;sample.event.num&quot;,&quot;year&quot;)) %&gt;%
  # convert season datetimes to day-of-year (&quot;doy&quot;)
  mutate(season.start.doy = yday(season.start),
         season.end.doy = yday(season.end),
         event.start.doy = yday(event.start)) %&gt;%
  transform(year = as.factor(year))

# set plottling theme (mostly)
theme_bm &lt;- theme(axis.text.x = element_text(size=18),
                  axis.text.y = element_text(size=18),                       # x axis text
                  axis.title.x = element_text(size=18, face = &quot;bold&quot;),          # x axis title
                  axis.title.y = element_text(size=18, face = &quot;bold&quot;),
                  strip.text.x = element_text(size = 16, face = &quot;bold&quot;),
                  legend.text = element_text(size = 16)) 

# test plot
s &lt;- ggplot(effort_fnl, aes(x=season.start.doy, xend = season.end.doy, 
                            y=year, yend=year), color = season) +
  theme_bw() +
  ggtitle(&quot;Fish Sampling Periods&quot;) +
  geom_segment(aes(color = season), size = 24) + 
  facet_wrap(~River) +
  geom_point(aes(event.start.doy, year), size = 3) +  
  xlab(&quot;Day of Year&quot;) +
  ylab(&quot;Year&quot;) +
  theme(plot.title = element_text(size= 30, face = &quot;bold&quot;, hjust = 0.5)) +
  theme(legend.title=element_text(size=24)) +
  guides(color = guide_legend(override.aes = list(size=8))) +
  scale_color_discrete(name=&quot;Season&quot;,
                       breaks=c(&quot;Early Summer&quot;,
                                &quot;Mid-Summer&quot;,
                                &quot;Late Summer&quot;,
                                &quot;Fall&quot;)) +
  scale_shape_manual() +
  theme_bm

# print plot
s </code></pre>
<div class="figure">
<img src="create_size_input_mkdown_files/figure-html/fish%20sampling%20periods-1.png" alt="**Figure X -** Fish sampling periods.  Each black dot indicates a day of a fish sampling event (numerical day of year).  Each colored bar denotes the length of a 'season,' or period of time between the first and last of a drainage's monthly site visits." width="960" />
<p class="caption">
<strong>Figure X -</strong> Fish sampling periods. Each black dot indicates a day of a fish sampling event (numerical day of year). Each colored bar denotes the length of a ‘season,’ or period of time between the first and last of a drainage’s monthly site visits.
</p>
</div>
<hr />
<p><br></p>
<pre class="r"><code># print table
effort_fnl</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.event"],"name":[1],"type":["chr"],"align":["left"]},{"label":["River"],"name":[2],"type":["chr"],"align":["left"]},{"label":["sample.event.num"],"name":[3],"type":["chr"],"align":["left"]},{"label":["year"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["event.start"],"name":[5],"type":["S3: POSIXct"],"align":["right"]},{"label":["event.end"],"name":[6],"type":["S3: POSIXct"],"align":["right"]},{"label":["hours"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["doy"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["season.start"],"name":[9],"type":["S3: POSIXct"],"align":["right"]},{"label":["season.end"],"name":[10],"type":["S3: POSIXct"],"align":["right"]},{"label":["season"],"name":[11],"type":["chr"],"align":["left"]},{"label":["days"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["season.start.doy"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["season.end.doy"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["event.start.doy"],"name":[15],"type":["dbl"],"align":["right"]}],"data":[{"1":"LBC-2015-1","2":"Beaver Creek","3":"1","4":"2015","5":"2015-06-04 14:14:00","6":"2015-06-05 18:07:00","7":"27.883333","8":"155","9":"2015-06-04 14:14:00","10":"2015-06-07 16:22:00","11":"Early Summer","12":"3.088889","13":"155","14":"158","15":"155"},{"1":"LBC-2015-2","2":"Beaver Creek","3":"2","4":"2015","5":"2015-06-29 01:00:00","6":"2015-06-30 15:00:00","7":"38.000000","8":"180","9":"2015-06-29 01:00:00","10":"2015-07-13 17:14:00","11":"Mid-Summer","12":"14.676389","13":"180","14":"194","15":"180"},{"1":"LBC-2015-3","2":"Beaver Creek","3":"3","4":"2015","5":"2015-08-06 01:00:00","6":"2015-08-06 16:22:00","7":"15.366667","8":"218","9":"2015-08-06 01:00:00","10":"2015-08-10 16:13:00","11":"Late Summer","12":"4.634028","13":"218","14":"222","15":"218"},{"1":"LBC-2016-1","2":"Beaver Creek","3":"1","4":"2016","5":"2016-05-24 11:36:00","6":"2016-05-24 17:22:00","7":"5.766667","8":"145","9":"2016-05-24 11:36:00","10":"2016-05-26 16:33:00","11":"Early Summer","12":"2.206250","13":"145","14":"147","15":"145"},{"1":"LBC-2016-2","2":"Beaver Creek","3":"2","4":"2016","5":"2016-06-21 01:00:00","6":"2016-06-21 18:50:00","7":"17.833333","8":"173","9":"2016-06-20 11:15:00","10":"2016-06-22 16:26:00","11":"Mid-Summer","12":"2.215972","13":"172","14":"174","15":"173"},{"1":"LBC-2016-3","2":"Beaver Creek","3":"3","4":"2016","5":"2016-07-19 12:30:00","6":"2016-07-19 19:20:00","7":"6.833333","8":"201","9":"2016-07-19 12:30:00","10":"2016-07-22 16:50:00","11":"Late Summer","12":"3.180556","13":"201","14":"204","15":"201"},{"1":"LBC-2016-4","2":"Beaver Creek","3":"4","4":"2016","5":"2016-08-15 11:55:00","6":"2016-08-15 17:50:00","7":"5.916667","8":"228","9":"2016-08-15 11:55:00","10":"2016-08-17 18:00:00","11":"Fall","12":"2.253472","13":"228","14":"230","15":"228"},{"1":"LPC-2015-1","2":"Ptarmigan Creek","3":"1","4":"2015","5":"2015-06-23 15:38:00","6":"2015-06-25 15:00:00","7":"47.366667","8":"174","9":"2015-06-23 15:38:00","10":"2015-07-01 14:00:00","11":"Early Summer","12":"7.931944","13":"174","14":"182","15":"174"},{"1":"LPC-2015-2","2":"Ptarmigan Creek","3":"2","4":"2015","5":"2015-07-30 12:39:00","6":"2015-07-30 18:22:00","7":"5.716667","8":"211","9":"2015-07-16 12:37:00","10":"2015-07-31 16:13:00","11":"Mid-Summer","12":"15.150000","13":"197","14":"212","15":"211"},{"1":"LPC-2015-3","2":"Ptarmigan Creek","3":"3","4":"2015","5":"2015-08-25 12:33:00","6":"2015-08-25 19:42:00","7":"7.150000","8":"237","9":"2015-08-25 12:33:00","10":"2015-08-26 18:20:00","11":"Late Summer","12":"1.240972","13":"237","14":"238","15":"237"},{"1":"LPC-2016-1","2":"Ptarmigan Creek","3":"1","4":"2016","5":"2016-06-05 13:30:00","6":"2016-06-05 17:25:00","7":"3.916667","8":"157","9":"2016-06-05 13:30:00","10":"2016-06-06 14:50:00","11":"Early Summer","12":"1.055556","13":"157","14":"158","15":"157"},{"1":"LPC-2016-2","2":"Ptarmigan Creek","3":"2","4":"2016","5":"2016-07-01 11:25:00","6":"2016-07-01 15:35:00","7":"4.166667","8":"183","9":"2016-07-01 11:25:00","10":"2016-07-02 14:58:00","11":"Mid-Summer","12":"1.147917","13":"183","14":"184","15":"183"},{"1":"LPC-2016-3","2":"Ptarmigan Creek","3":"3","4":"2016","5":"2016-08-10 01:00:00","6":"2016-08-10 16:15:00","7":"15.250000","8":"223","9":"2016-08-10 01:00:00","10":"2016-08-11 16:20:00","11":"Late Summer","12":"1.638889","13":"223","14":"224","15":"223"},{"1":"LPC-2016-4","2":"Ptarmigan Creek","3":"4","4":"2016","5":"2016-09-17 12:05:00","6":"2016-09-17 17:20:00","7":"5.250000","8":"261","9":"2016-09-17 12:05:00","10":"2016-09-17 17:20:00","11":"Fall","12":"0.218750","13":"261","14":"261","15":"261"},{"1":"LRR-2015-1","2":"Russian River","3":"1","4":"2015","5":"2015-06-08 16:34:00","6":"2015-06-09 18:20:00","7":"25.766667","8":"159","9":"2015-06-08 16:34:00","10":"2015-06-19 18:52:00","11":"Early Summer","12":"11.095833","13":"159","14":"170","15":"159"},{"1":"LRR-2015-2","2":"Russian River","3":"2","4":"2015","5":"2015-07-14 12:00:00","6":"2015-07-14 17:22:00","7":"5.366667","8":"195","9":"2015-07-14 12:00:00","10":"2015-07-21 17:32:00","11":"Mid-Summer","12":"7.230556","13":"195","14":"202","15":"195"},{"1":"LRR-2015-3","2":"Russian River","3":"3","4":"2015","5":"2015-08-11 12:00:00","6":"2015-08-11 18:18:00","7":"6.300000","8":"223","9":"2015-08-11 12:00:00","10":"2015-08-20 17:30:00","11":"Late Summer","12":"9.229167","13":"223","14":"232","15":"223"},{"1":"LRR-2016-1","2":"Russian River","3":"1","4":"2016","5":"2016-05-31 12:25:00","6":"2016-05-31 17:45:00","7":"5.333333","8":"152","9":"2016-05-31 12:25:00","10":"2016-06-08 17:05:00","11":"Early Summer","12":"8.194444","13":"152","14":"160","15":"152"},{"1":"LRR-2016-2","2":"Russian River","3":"2","4":"2016","5":"2016-07-18 12:20:00","6":"2016-07-18 18:25:00","7":"6.083333","8":"200","9":"2016-06-30 13:55:00","10":"2016-07-18 18:25:00","11":"Mid-Summer","12":"18.187500","13":"182","14":"200","15":"200"},{"1":"LRR-2016-3","2":"Russian River","3":"3","4":"2016","5":"2016-08-09 12:35:00","6":"2016-08-09 17:15:00","7":"4.666667","8":"222","9":"2016-08-04 14:05:00","10":"2016-08-09 17:15:00","11":"Late Summer","12":"5.131944","13":"217","14":"222","15":"222"},{"1":"LRR-2016-4","2":"Russian River","3":"4","4":"2016","5":"2016-09-02 12:35:00","6":"2016-09-02 17:50:00","7":"5.250000","8":"246","9":"2016-09-02 12:35:00","10":"2016-09-11 17:35:00","11":"Fall","12":"9.208333","13":"246","14":"255","15":"246"},{"1":"MBC-2015-1","2":"Beaver Creek","3":"1","4":"2015","5":"2015-06-07 12:05:00","6":"2015-06-07 16:22:00","7":"4.283333","8":"158","9":"2015-06-04 14:14:00","10":"2015-06-07 16:22:00","11":"Early Summer","12":"3.088889","13":"155","14":"158","15":"158"},{"1":"MBC-2015-2","2":"Beaver Creek","3":"2","4":"2015","5":"2015-07-13 11:10:00","6":"2015-07-13 17:14:00","7":"6.066667","8":"194","9":"2015-06-29 01:00:00","10":"2015-07-13 17:14:00","11":"Mid-Summer","12":"14.676389","13":"180","14":"194","15":"194"},{"1":"MBC-2015-3","2":"Beaver Creek","3":"3","4":"2015","5":"2015-08-10 11:49:00","6":"2015-08-10 16:13:00","7":"4.400000","8":"222","9":"2015-08-06 01:00:00","10":"2015-08-10 16:13:00","11":"Late Summer","12":"4.634028","13":"218","14":"222","15":"222"},{"1":"MBC-2016-1","2":"Beaver Creek","3":"1","4":"2016","5":"2016-05-25 11:37:00","6":"2016-05-25 17:25:00","7":"5.800000","8":"146","9":"2016-05-24 11:36:00","10":"2016-05-26 16:33:00","11":"Early Summer","12":"2.206250","13":"145","14":"147","15":"146"},{"1":"MBC-2016-2","2":"Beaver Creek","3":"2","4":"2016","5":"2016-06-20 11:15:00","6":"2016-06-20 17:25:00","7":"6.166667","8":"172","9":"2016-06-20 11:15:00","10":"2016-06-22 16:26:00","11":"Mid-Summer","12":"2.215972","13":"172","14":"174","15":"172"},{"1":"MBC-2016-3","2":"Beaver Creek","3":"3","4":"2016","5":"2016-07-20 11:30:00","6":"2016-07-20 17:05:00","7":"5.583333","8":"202","9":"2016-07-19 12:30:00","10":"2016-07-22 16:50:00","11":"Late Summer","12":"3.180556","13":"201","14":"204","15":"202"},{"1":"MBC-2016-4","2":"Beaver Creek","3":"4","4":"2016","5":"2016-08-16 11:30:00","6":"2016-08-16 17:50:00","7":"6.333333","8":"229","9":"2016-08-15 11:55:00","10":"2016-08-17 18:00:00","11":"Fall","12":"2.253472","13":"228","14":"230","15":"229"},{"1":"MPC-2015-1","2":"Ptarmigan Creek","3":"1","4":"2015","5":"2015-06-24 13:38:00","6":"2015-06-24 17:45:00","7":"4.116667","8":"175","9":"2015-06-23 15:38:00","10":"2015-07-01 14:00:00","11":"Early Summer","12":"7.931944","13":"174","14":"182","15":"175"},{"1":"MPC-2015-2","2":"Ptarmigan Creek","3":"2","4":"2015","5":"2015-07-16 12:37:00","6":"2015-07-31 16:13:00","7":"363.600000","8":"197","9":"2015-07-16 12:37:00","10":"2015-07-31 16:13:00","11":"Mid-Summer","12":"15.150000","13":"197","14":"212","15":"197"},{"1":"MPC-2015-3","2":"Ptarmigan Creek","3":"3","4":"2015","5":"2015-08-26 13:36:00","6":"2015-08-26 18:20:00","7":"4.733333","8":"238","9":"2015-08-25 12:33:00","10":"2015-08-26 18:20:00","11":"Late Summer","12":"1.240972","13":"237","14":"238","15":"238"},{"1":"MPC-2016-1","2":"Ptarmigan Creek","3":"1","4":"2016","5":"2016-06-06 01:00:00","6":"2016-06-06 14:50:00","7":"13.833333","8":"158","9":"2016-06-05 13:30:00","10":"2016-06-06 14:50:00","11":"Early Summer","12":"1.055556","13":"157","14":"158","15":"158"},{"1":"MPC-2016-2","2":"Ptarmigan Creek","3":"2","4":"2016","5":"2016-07-02 11:10:00","6":"2016-07-02 14:58:00","7":"3.800000","8":"184","9":"2016-07-01 11:25:00","10":"2016-07-02 14:58:00","11":"Mid-Summer","12":"1.147917","13":"183","14":"184","15":"184"},{"1":"MPC-2016-3","2":"Ptarmigan Creek","3":"3","4":"2016","5":"2016-08-11 12:05:00","6":"2016-08-11 16:20:00","7":"4.250000","8":"224","9":"2016-08-10 01:00:00","10":"2016-08-11 16:20:00","11":"Late Summer","12":"1.638889","13":"223","14":"224","15":"224"},{"1":"MRR-2015-1","2":"Russian River","3":"1","4":"2015","5":"2015-06-19 13:45:00","6":"2015-06-19 18:52:00","7":"5.116667","8":"170","9":"2015-06-08 16:34:00","10":"2015-06-19 18:52:00","11":"Early Summer","12":"11.095833","13":"159","14":"170","15":"170"},{"1":"MRR-2015-2","2":"Russian River","3":"2","4":"2015","5":"2015-07-15 12:30:00","6":"2015-07-15 16:55:00","7":"4.416667","8":"196","9":"2015-07-14 12:00:00","10":"2015-07-21 17:32:00","11":"Mid-Summer","12":"7.230556","13":"195","14":"202","15":"196"},{"1":"MRR-2015-3","2":"Russian River","3":"3","4":"2015","5":"2015-08-12 12:22:00","6":"2015-08-12 18:20:00","7":"5.966667","8":"224","9":"2015-08-11 12:00:00","10":"2015-08-20 17:30:00","11":"Late Summer","12":"9.229167","13":"223","14":"232","15":"224"},{"1":"MRR-2016-1","2":"Russian River","3":"1","4":"2016","5":"2016-06-01 11:30:00","6":"2016-06-01 17:00:00","7":"5.500000","8":"153","9":"2016-05-31 12:25:00","10":"2016-06-08 17:05:00","11":"Early Summer","12":"8.194444","13":"152","14":"160","15":"153"},{"1":"MRR-2016-2","2":"Russian River","3":"2","4":"2016","5":"2016-06-30 13:55:00","6":"2016-06-30 18:39:00","7":"4.733333","8":"182","9":"2016-06-30 13:55:00","10":"2016-07-18 18:25:00","11":"Mid-Summer","12":"18.187500","13":"182","14":"200","15":"182"},{"1":"MRR-2016-3","2":"Russian River","3":"3","4":"2016","5":"2016-08-06 13:00:00","6":"2016-08-06 17:40:00","7":"4.666667","8":"219","9":"2016-08-04 14:05:00","10":"2016-08-09 17:15:00","11":"Late Summer","12":"5.131944","13":"217","14":"222","15":"219"},{"1":"MRR-2016-4","2":"Russian River","3":"4","4":"2016","5":"2016-09-03 12:45:00","6":"2016-09-03 17:00:00","7":"4.250000","8":"247","9":"2016-09-02 12:35:00","10":"2016-09-11 17:35:00","11":"Fall","12":"9.208333","13":"246","14":"255","15":"247"},{"1":"MSKR-2015-1","2":"Kenai River","3":"1","4":"2015","5":"2015-06-22 13:00:00","6":"2015-06-22 17:10:00","7":"4.166667","8":"173","9":"2015-06-09 12:10:00","10":"2015-06-22 17:10:00","11":"Early Summer","12":"13.208333","13":"160","14":"173","15":"173"},{"1":"MSKR-2015-2","2":"Kenai River","3":"2","4":"2015","5":"2015-07-23 12:25:00","6":"2015-07-23 17:45:00","7":"5.333333","8":"204","9":"2015-07-23 12:25:00","10":"2015-07-24 17:14:00","11":"Mid-Summer","12":"1.200694","13":"204","14":"205","15":"204"},{"1":"MSKR-2015-3","2":"Kenai River","3":"3","4":"2015","5":"2015-08-13 12:16:00","6":"2015-08-13 16:10:00","7":"3.900000","8":"225","9":"2015-08-13 12:16:00","10":"2015-08-17 18:28:00","11":"Late Summer","12":"4.258333","13":"225","14":"229","15":"225"},{"1":"MSKR-2016-1","2":"Kenai River","3":"1","4":"2016","5":"2016-05-30 11:35:00","6":"2016-05-30 15:55:00","7":"4.333333","8":"151","9":"2016-05-30 11:35:00","10":"2016-06-02 16:00:00","11":"Early Summer","12":"3.184028","13":"151","14":"154","15":"151"},{"1":"MSKR-2016-2","2":"Kenai River","3":"2","4":"2016","5":"2016-06-28 11:05:00","6":"2016-06-28 17:30:00","7":"6.416667","8":"180","9":"2016-06-28 11:05:00","10":"2016-06-29 12:45:00","11":"Mid-Summer","12":"1.069444","13":"180","14":"181","15":"180"},{"1":"MSKR-2016-3","2":"Kenai River","3":"3","4":"2016","5":"2016-08-01 11:45:00","6":"2016-08-01 17:40:00","7":"5.916667","8":"214","9":"2016-08-01 11:45:00","10":"2016-08-02 17:10:00","11":"Late Summer","12":"1.225694","13":"214","14":"215","15":"214"},{"1":"MSKR-2016-4","2":"Kenai River","3":"4","4":"2016","5":"2016-08-31 11:25:00","6":"2016-08-31 16:20:00","7":"4.916667","8":"244","9":"2016-08-31 11:25:00","10":"2016-09-04 16:35:00","11":"Fall","12":"4.215278","13":"244","14":"248","15":"244"},{"1":"MSRR-2015-1","2":"Kenai River","3":"1","4":"2015","5":"2015-06-09 12:10:00","6":"2015-06-09 14:52:00","7":"2.700000","8":"160","9":"2015-06-09 12:10:00","10":"2015-06-22 17:10:00","11":"Early Summer","12":"13.208333","13":"160","14":"173","15":"160"},{"1":"MSRR-2015-2","2":"Kenai River","3":"2","4":"2015","5":"2015-07-24 13:04:00","6":"2015-07-24 17:14:00","7":"4.166667","8":"205","9":"2015-07-23 12:25:00","10":"2015-07-24 17:14:00","11":"Mid-Summer","12":"1.200694","13":"204","14":"205","15":"205"},{"1":"MSRR-2015-3","2":"Kenai River","3":"3","4":"2015","5":"2015-08-17 12:45:00","6":"2015-08-17 18:28:00","7":"5.716667","8":"229","9":"2015-08-13 12:16:00","10":"2015-08-17 18:28:00","11":"Late Summer","12":"4.258333","13":"225","14":"229","15":"229"},{"1":"MSRR-2016-1","2":"Kenai River","3":"1","4":"2016","5":"2016-06-02 11:00:00","6":"2016-06-02 16:00:00","7":"5.000000","8":"154","9":"2016-05-30 11:35:00","10":"2016-06-02 16:00:00","11":"Early Summer","12":"3.184028","13":"151","14":"154","15":"154"},{"1":"MSRR-2016-2","2":"Kenai River","3":"2","4":"2016","5":"2016-06-29 11:35:00","6":"2016-06-29 12:45:00","7":"1.166667","8":"181","9":"2016-06-28 11:05:00","10":"2016-06-29 12:45:00","11":"Mid-Summer","12":"1.069444","13":"180","14":"181","15":"181"},{"1":"MSRR-2016-3","2":"Kenai River","3":"3","4":"2016","5":"2016-08-02 13:00:00","6":"2016-08-02 17:10:00","7":"4.166667","8":"215","9":"2016-08-01 11:45:00","10":"2016-08-02 17:10:00","11":"Late Summer","12":"1.225694","13":"214","14":"215","15":"215"},{"1":"MSRR-2016-4","2":"Kenai River","3":"4","4":"2016","5":"2016-09-04 11:50:00","6":"2016-09-04 16:35:00","7":"4.750000","8":"248","9":"2016-08-31 11:25:00","10":"2016-09-04 16:35:00","11":"Fall","12":"4.215278","13":"244","14":"248","15":"248"},{"1":"UBC-2015-1","2":"Beaver Creek","3":"1","4":"2015","5":"2015-06-06 12:22:00","6":"2015-06-06 16:42:00","7":"4.333333","8":"157","9":"2015-06-04 14:14:00","10":"2015-06-07 16:22:00","11":"Early Summer","12":"3.088889","13":"155","14":"158","15":"157"},{"1":"UBC-2015-2","2":"Beaver Creek","3":"2","4":"2015","5":"2015-07-02 11:33:00","6":"2015-07-02 17:15:00","7":"5.700000","8":"183","9":"2015-06-29 01:00:00","10":"2015-07-13 17:14:00","11":"Mid-Summer","12":"14.676389","13":"180","14":"194","15":"183"},{"1":"UBC-2015-3","2":"Beaver Creek","3":"3","4":"2015","5":"2015-08-07 11:42:00","6":"2015-08-07 13:15:00","7":"1.550000","8":"219","9":"2015-08-06 01:00:00","10":"2015-08-10 16:13:00","11":"Late Summer","12":"4.634028","13":"218","14":"222","15":"219"},{"1":"UBC-2016-1","2":"Beaver Creek","3":"1","4":"2016","5":"2016-05-26 12:35:00","6":"2016-05-26 16:33:00","7":"3.966667","8":"147","9":"2016-05-24 11:36:00","10":"2016-05-26 16:33:00","11":"Early Summer","12":"2.206250","13":"145","14":"147","15":"147"},{"1":"UBC-2016-2","2":"Beaver Creek","3":"2","4":"2016","5":"2016-06-22 12:45:00","6":"2016-06-22 16:26:00","7":"3.683333","8":"174","9":"2016-06-20 11:15:00","10":"2016-06-22 16:26:00","11":"Mid-Summer","12":"2.215972","13":"172","14":"174","15":"174"},{"1":"UBC-2016-3","2":"Beaver Creek","3":"3","4":"2016","5":"2016-07-22 12:45:00","6":"2016-07-22 16:50:00","7":"4.083333","8":"204","9":"2016-07-19 12:30:00","10":"2016-07-22 16:50:00","11":"Late Summer","12":"3.180556","13":"201","14":"204","15":"204"},{"1":"UBC-2016-4","2":"Beaver Creek","3":"4","4":"2016","5":"2016-08-17 13:55:00","6":"2016-08-17 18:00:00","7":"4.083333","8":"230","9":"2016-08-15 11:55:00","10":"2016-08-17 18:00:00","11":"Fall","12":"2.253472","13":"228","14":"230","15":"230"},{"1":"UPC-2015-1","2":"Ptarmigan Creek","3":"1","4":"2015","5":"2015-07-01 01:00:00","6":"2015-07-01 14:00:00","7":"13.000000","8":"182","9":"2015-06-23 15:38:00","10":"2015-07-01 14:00:00","11":"Early Summer","12":"7.931944","13":"174","14":"182","15":"182"},{"1":"URR-2015-1","2":"Russian River","3":"1","4":"2015","5":"2015-06-16 12:25:00","6":"2015-06-16 18:45:00","7":"6.333333","8":"167","9":"2015-06-08 16:34:00","10":"2015-06-19 18:52:00","11":"Early Summer","12":"11.095833","13":"159","14":"170","15":"167"},{"1":"URR-2015-2","2":"Russian River","3":"2","4":"2015","5":"2015-07-21 11:10:00","6":"2015-07-21 17:32:00","7":"6.366667","8":"202","9":"2015-07-14 12:00:00","10":"2015-07-21 17:32:00","11":"Mid-Summer","12":"7.230556","13":"195","14":"202","15":"202"},{"1":"URR-2015-3","2":"Russian River","3":"3","4":"2015","5":"2015-08-20 12:42:00","6":"2015-08-20 17:30:00","7":"4.800000","8":"232","9":"2015-08-11 12:00:00","10":"2015-08-20 17:30:00","11":"Late Summer","12":"9.229167","13":"223","14":"232","15":"232"},{"1":"URR-2016-1","2":"Russian River","3":"1","4":"2016","5":"2016-06-08 12:55:00","6":"2016-06-08 17:05:00","7":"4.166667","8":"160","9":"2016-05-31 12:25:00","10":"2016-06-08 17:05:00","11":"Early Summer","12":"8.194444","13":"152","14":"160","15":"160"},{"1":"URR-2016-2","2":"Russian River","3":"2","4":"2016","5":"2016-07-08 01:00:00","6":"2016-07-08 15:20:00","7":"14.333333","8":"190","9":"2016-06-30 13:55:00","10":"2016-07-18 18:25:00","11":"Mid-Summer","12":"18.187500","13":"182","14":"200","15":"190"},{"1":"URR-2016-3","2":"Russian River","3":"3","4":"2016","5":"2016-08-04 14:05:00","6":"2016-08-04 19:25:00","7":"5.333333","8":"217","9":"2016-08-04 14:05:00","10":"2016-08-09 17:15:00","11":"Late Summer","12":"5.131944","13":"217","14":"222","15":"217"},{"1":"URR-2016-4","2":"Russian River","3":"4","4":"2016","5":"2016-09-11 13:05:00","6":"2016-09-11 17:35:00","7":"4.500000","8":"255","9":"2016-09-02 12:35:00","10":"2016-09-11 17:35:00","11":"Fall","12":"9.208333","13":"246","14":"255","15":"255"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[4],"max":[4]},"pages":{}}}
  </script>
</div>
<p><strong>Table X -</strong> Table of fish sampling event data.</p>
<hr />
<p><br> <br></p>
</div>
<div id="overall-catch-summary" class="section level3">
<h3>Overall Catch summary</h3>
<p>A total of 4432 juvenile Coho and Chinook were captured thoughout the 2015/2016 sampling periods, with 981 of the fish sampled for diet contents using gastric lavage technique. Chinook were generally sparse relative to Coho, except in the main stem Kenai River.</p>
<pre class="r"><code># plot and title for 2016 data
allplot + ggtitle(&quot;Overall Capture 2015 and 2016\n Juvenile Chinook and Coho&quot;)</code></pre>
<p><img src="create_size_input_mkdown_files/figure-html/render%20overall%20catch%20plot-1.png" width="960" /></p>
<hr />
<p><br></p>
<pre class="r"><code># 2015 &amp; 2016 catch data

# 2015 

# Verify that sheet is present, create object of sheet with all tabs
SCTC2015 &lt;- gs_title(&quot;2015 EPSCoR SCTC.xlsx&quot;)

# read in desired worksheet
catch15 &lt;- SCTC2015 %&gt;% 
  gs_read(ws = &quot;C 2015 Diet &amp; LW Data&quot;,col_names=TRUE) %&gt;%
  select(Year,river,spp,Count,sample.event.num,DS) %&gt;%
  mutate(season = fct_recode(as.factor(sample.event.num),         #code sampling events as seasons
                             &quot;Early Summer&quot;=&quot;1&quot;, 
                             &quot;Mid-Summer&quot; = &quot;2&quot;,
                             &quot;Late Summer&quot; =&quot;3&quot;)) %&gt;%
  rename(diet_sample = DS) %&gt;%
  filter(spp %in% c(&quot;Coho&quot;, &quot;Chinook&quot;)) # filter out all species except Chinook and Coho</code></pre>
<p>Downloading: 1.2 kB<br />
Downloading: 1.2 kB<br />
Downloading: 2.6 kB<br />
Downloading: 2.6 kB<br />
Downloading: 3.7 kB<br />
Downloading: 3.7 kB<br />
Downloading: 3.7 kB<br />
Downloading: 3.7 kB<br />
Downloading: 5 kB<br />
Downloading: 5 kB<br />
Downloading: 5.1 kB<br />
Downloading: 5.1 kB<br />
Downloading: 6.4 kB<br />
Downloading: 6.4 kB<br />
Downloading: 6.5 kB<br />
Downloading: 6.5 kB<br />
Downloading: 7.8 kB<br />
Downloading: 7.8 kB<br />
Downloading: 7.8 kB<br />
Downloading: 7.8 kB<br />
Downloading: 9.1 kB<br />
Downloading: 9.1 kB<br />
Downloading: 9.2 kB<br />
Downloading: 9.2 kB<br />
Downloading: 10 kB<br />
Downloading: 10 kB<br />
Downloading: 11 kB<br />
Downloading: 11 kB<br />
Downloading: 13 kB<br />
Downloading: 13 kB<br />
Downloading: 13 kB<br />
Downloading: 13 kB<br />
Downloading: 14 kB<br />
Downloading: 14 kB<br />
Downloading: 15 kB<br />
Downloading: 15 kB<br />
Downloading: 16 kB<br />
Downloading: 16 kB<br />
Downloading: 16 kB<br />
Downloading: 16 kB<br />
Downloading: 18 kB<br />
Downloading: 18 kB<br />
Downloading: 18 kB<br />
Downloading: 18 kB<br />
Downloading: 19 kB<br />
Downloading: 19 kB<br />
Downloading: 19 kB<br />
Downloading: 19 kB<br />
Downloading: 20 kB<br />
Downloading: 20 kB<br />
Downloading: 22 kB<br />
Downloading: 22 kB<br />
Downloading: 23 kB<br />
Downloading: 23 kB<br />
Downloading: 25 kB<br />
Downloading: 25 kB<br />
Downloading: 25 kB<br />
Downloading: 25 kB<br />
Downloading: 27 kB<br />
Downloading: 27 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB</p>
<pre class="r"><code># create summary of catch by drainage, species, and lavaged vs non-lavaged
catch_summary15 &lt;- catch15 %&gt;%
  group_by(Year,river,spp,diet_sample) %&gt;%
  summarise(ct = sum(Count)) %&gt;%
  mutate(count_label = paste(&quot;( n=&quot;, as.character(ct),&quot;)&quot;)) #create count labels

# 2016 

# import 2016 database, create object of sheet with all tabs
SCTC2016 &lt;- gs_title(&quot;2016_EPSCoR_Aquatic_Ecology_Database&quot;)

# read in desired worksheet
catch16 &lt;- SCTC2016 %&gt;% 
  gs_read(ws = &quot;C 2016 Diet &amp; LW Data&quot;,col_names=TRUE) %&gt;%
  select(Year,river,spp,Count,sample.event.num,DS) %&gt;%
  mutate(season = fct_recode(as.factor(sample.event.num),         #code sampling events as seasons
                             &quot;Early Summer&quot;=&quot;1&quot;, 
                             &quot;Mid-Summer&quot; = &quot;2&quot;,
                             &quot;Late Summer&quot; =&quot;3&quot;,
                             &quot;Fall&quot; = &quot;4&quot;)) %&gt;%
  rename(diet_sample = DS) %&gt;%
  filter(spp %in% c(&quot;Coho&quot;, &quot;Chinook&quot;)) # filter out all species except Chinook and Coho</code></pre>
<p>Downloading: 1.2 kB<br />
Downloading: 1.2 kB<br />
Downloading: 2.6 kB<br />
Downloading: 2.6 kB<br />
Downloading: 2.9 kB<br />
Downloading: 2.9 kB<br />
Downloading: 3.9 kB<br />
Downloading: 3.9 kB<br />
Downloading: 4.9 kB<br />
Downloading: 4.9 kB<br />
Downloading: 5.9 kB<br />
Downloading: 5.9 kB<br />
Downloading: 6.8 kB<br />
Downloading: 6.8 kB<br />
Downloading: 8 kB<br />
Downloading: 8 kB<br />
Downloading: 9.1 kB<br />
Downloading: 9.1 kB<br />
Downloading: 10 kB<br />
Downloading: 10 kB<br />
Downloading: 10 kB<br />
Downloading: 10 kB<br />
Downloading: 12 kB<br />
Downloading: 12 kB<br />
Downloading: 12 kB<br />
Downloading: 12 kB<br />
Downloading: 13 kB<br />
Downloading: 13 kB<br />
Downloading: 13 kB<br />
Downloading: 13 kB<br />
Downloading: 14 kB<br />
Downloading: 14 kB<br />
Downloading: 15 kB<br />
Downloading: 15 kB<br />
Downloading: 15 kB<br />
Downloading: 15 kB<br />
Downloading: 17 kB<br />
Downloading: 17 kB<br />
Downloading: 17 kB<br />
Downloading: 17 kB<br />
Downloading: 18 kB<br />
Downloading: 18 kB<br />
Downloading: 19 kB<br />
Downloading: 19 kB<br />
Downloading: 21 kB<br />
Downloading: 21 kB<br />
Downloading: 21 kB<br />
Downloading: 21 kB<br />
Downloading: 22 kB<br />
Downloading: 22 kB<br />
Downloading: 24 kB<br />
Downloading: 24 kB<br />
Downloading: 24 kB<br />
Downloading: 24 kB<br />
Downloading: 25 kB<br />
Downloading: 25 kB<br />
Downloading: 25 kB<br />
Downloading: 25 kB<br />
Downloading: 27 kB<br />
Downloading: 27 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 28 kB<br />
Downloading: 29 kB<br />
Downloading: 29 kB<br />
Downloading: 30 kB<br />
Downloading: 30 kB<br />
Downloading: 31 kB<br />
Downloading: 31 kB<br />
Downloading: 31 kB<br />
Downloading: 31 kB<br />
Downloading: 32 kB<br />
Downloading: 32 kB<br />
Downloading: 34 kB<br />
Downloading: 34 kB<br />
Downloading: 35 kB<br />
Downloading: 35 kB<br />
Downloading: 35 kB<br />
Downloading: 35 kB<br />
Downloading: 35 kB<br />
Downloading: 35 kB<br />
Downloading: 37 kB<br />
Downloading: 37 kB<br />
Downloading: 37 kB<br />
Downloading: 37 kB<br />
Downloading: 38 kB<br />
Downloading: 38 kB<br />
Downloading: 38 kB<br />
Downloading: 38 kB<br />
Downloading: 40 kB<br />
Downloading: 40 kB<br />
Downloading: 40 kB<br />
Downloading: 40 kB<br />
Downloading: 41 kB<br />
Downloading: 41 kB<br />
Downloading: 41 kB<br />
Downloading: 41 kB<br />
Downloading: 42 kB<br />
Downloading: 42 kB<br />
Downloading: 44 kB<br />
Downloading: 44 kB<br />
Downloading: 45 kB<br />
Downloading: 45 kB<br />
Downloading: 45 kB<br />
Downloading: 45 kB<br />
Downloading: 46 kB<br />
Downloading: 46 kB<br />
Downloading: 47 kB<br />
Downloading: 47 kB<br />
Downloading: 48 kB<br />
Downloading: 48 kB<br />
Downloading: 49 kB<br />
Downloading: 49 kB<br />
Downloading: 50 kB<br />
Downloading: 50 kB<br />
Downloading: 51 kB<br />
Downloading: 51 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB<br />
Downloading: 52 kB</p>
<pre class="r"><code># create summary of catch by drainage, species, and lavaged vs non-lavaged
catch_summary16 &lt;- catch16 %&gt;%
  group_by(Year,river,spp,diet_sample) %&gt;%
  summarise(ct = sum(Count)) %&gt;%
  mutate(count_label = paste(&quot;( n=&quot;, as.character(ct),&quot;)&quot;)) #create count labels


# create combined table
all &lt;- bind_rows(catch_summary15,catch_summary16)

# print table
all</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Year"],"name":[1],"type":["int"],"align":["right"]},{"label":["river"],"name":[2],"type":["chr"],"align":["left"]},{"label":["spp"],"name":[3],"type":["chr"],"align":["left"]},{"label":["diet_sample"],"name":[4],"type":["chr"],"align":["left"]},{"label":["ct"],"name":[5],"type":["int"],"align":["right"]},{"label":["count_label"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"2015","2":"Beaver Creek","3":"Chinook","4":"N","5":"1","6":"( n= 1 )"},{"1":"2015","2":"Beaver Creek","3":"Chinook","4":"Y","5":"7","6":"( n= 7 )"},{"1":"2015","2":"Beaver Creek","3":"Coho","4":"N","5":"316","6":"( n= 316 )"},{"1":"2015","2":"Beaver Creek","3":"Coho","4":"Y","5":"135","6":"( n= 135 )"},{"1":"2015","2":"Kenai River","3":"Chinook","4":"N","5":"109","6":"( n= 109 )"},{"1":"2015","2":"Kenai River","3":"Chinook","4":"Y","5":"43","6":"( n= 43 )"},{"1":"2015","2":"Kenai River","3":"Coho","4":"N","5":"141","6":"( n= 141 )"},{"1":"2015","2":"Kenai River","3":"Coho","4":"Y","5":"24","6":"( n= 24 )"},{"1":"2015","2":"Ptarmigan Creek","3":"Chinook","4":"Y","5":"11","6":"( n= 11 )"},{"1":"2015","2":"Ptarmigan Creek","3":"Coho","4":"N","5":"91","6":"( n= 91 )"},{"1":"2015","2":"Ptarmigan Creek","3":"Coho","4":"Y","5":"102","6":"( n= 102 )"},{"1":"2015","2":"Russian River","3":"Chinook","4":"N","5":"19","6":"( n= 19 )"},{"1":"2015","2":"Russian River","3":"Chinook","4":"Y","5":"13","6":"( n= 13 )"},{"1":"2015","2":"Russian River","3":"Coho","4":"N","5":"313","6":"( n= 313 )"},{"1":"2015","2":"Russian River","3":"Coho","4":"Y","5":"123","6":"( n= 123 )"},{"1":"2016","2":"Beaver Creek","3":"Chinook","4":"N","5":"139","6":"( n= 139 )"},{"1":"2016","2":"Beaver Creek","3":"Chinook","4":"Y","5":"68","6":"( n= 68 )"},{"1":"2016","2":"Beaver Creek","3":"Coho","4":"N","5":"839","6":"( n= 839 )"},{"1":"2016","2":"Beaver Creek","3":"Coho","4":"Y","5":"127","6":"( n= 127 )"},{"1":"2016","2":"Kenai River","3":"Chinook","4":"N","5":"689","6":"( n= 689 )"},{"1":"2016","2":"Kenai River","3":"Chinook","4":"Y","5":"69","6":"( n= 69 )"},{"1":"2016","2":"Kenai River","3":"Coho","4":"N","5":"95","6":"( n= 95 )"},{"1":"2016","2":"Kenai River","3":"Coho","4":"Y","5":"29","6":"( n= 29 )"},{"1":"2016","2":"Ptarmigan Creek","3":"Chinook","4":"N","5":"16","6":"( n= 16 )"},{"1":"2016","2":"Ptarmigan Creek","3":"Chinook","4":"Y","5":"14","6":"( n= 14 )"},{"1":"2016","2":"Ptarmigan Creek","3":"Coho","4":"N","5":"131","6":"( n= 131 )"},{"1":"2016","2":"Ptarmigan Creek","3":"Coho","4":"Y","5":"57","6":"( n= 57 )"},{"1":"2016","2":"Russian River","3":"Chinook","4":"N","5":"39","6":"( n= 39 )"},{"1":"2016","2":"Russian River","3":"Chinook","4":"Y","5":"36","6":"( n= 36 )"},{"1":"2016","2":"Russian River","3":"Coho","4":"N","5":"513","6":"( n= 513 )"},{"1":"2016","2":"Russian River","3":"Coho","4":"Y","5":"123","6":"( n= 123 )"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[4],"max":[4]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># total catch count
# sum(all$ct) = 4432</code></pre>
<p><strong>Table X -</strong> Table of catch summary data.</p>
<hr />
<hr />
<p><br></p>
</div>
<div id="age-length-and-weight-data." class="section level3">
<h3>Age, length, and weight data.</h3>
<p>Length and weight data were acquired in the field using a measuring board and electronic balance. Age data was generated using scales collected from a subset of captured fish with &gt;50 mm fork length at each sampling event. Scales were aged by two independent observers under 4.0x magnification, and age-length keys were applied using methods detailed in Chapter 5 of “Introductory Fisheries Analysis with R” (Ogle 2016). <strong>(Link to age-length key methods/results write-up here when available).</strong></p>
<pre class="r"><code># Import resultant data from &quot;fish_ages_all.R&quot; script.  The script uses methods described in Ch. 5 of Ogle 2016 (&quot;Introductory fisheries analyses with R&quot;) to age all captured fish from a subset of fish scale samples.  Resultant csv file was copied to the google sheet referenced here.

# ID googlesheet with fish age data
fish_ages &lt;- gs_title(&quot;all_fish_ages.csv&quot;) 
Sys.sleep(6)
  
#read in worksheet containing diet data
dat &lt;- fish_ages %&gt;% 
  gs_read(ws = &quot;all_fish_ages.csv&quot;,col_names=TRUE) %&gt;% 
  select (-X1) %&gt;%
  separate(sample.event, c(&quot;reach&quot;,&quot;year&quot;,&quot;sample.event.num&quot;), sep = &quot;-&quot;, remove = F) %&gt;%
  unite(river_spp, river, spp, remove = F, sep = &quot; &quot;) %&gt;%
  # manually order appearance of seasons and rivers for plots
  transform(year = as.factor(year),
            river = factor(river, levels=c(&quot;Beaver Creek&quot;,
                                              &#39;Russian River&#39;,
                                              &#39;Ptarmigan Creek&#39;,
                                              &#39;Kenai River&#39;)),
            season = factor(season, levels = c(&quot;Early Summer&quot;,
                                     &quot;Mid-Summer&quot;,
                                     &quot;Late Summer&quot;,
                                     &quot;Fall&quot;)), 
            river_spp = as.factor(river_spp)) %&gt;%
  mutate(river_spp = paste(river,&quot;\n&quot;,spp))</code></pre>
<pre><code>## 
Downloading: 400 B     
Downloading: 400 B     
Downloading: 1.8 kB     
Downloading: 1.8 kB     
Downloading: 2.9 kB     
Downloading: 2.9 kB     
Downloading: 4.1 kB     
Downloading: 4.1 kB     
Downloading: 5 kB     
Downloading: 5 kB     
Downloading: 6.4 kB     
Downloading: 6.4 kB     
Downloading: 6.5 kB     
Downloading: 6.5 kB     
Downloading: 7.8 kB     
Downloading: 7.8 kB     
Downloading: 8.4 kB     
Downloading: 8.4 kB     
Downloading: 9.7 kB     
Downloading: 9.7 kB     
Downloading: 10 kB     
Downloading: 10 kB     
Downloading: 11 kB     
Downloading: 11 kB     
Downloading: 12 kB     
Downloading: 12 kB     
Downloading: 13 kB     
Downloading: 13 kB     
Downloading: 13 kB     
Downloading: 13 kB     
Downloading: 15 kB     
Downloading: 15 kB     
Downloading: 15 kB     
Downloading: 15 kB     
Downloading: 16 kB     
Downloading: 16 kB     
Downloading: 17 kB     
Downloading: 17 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 18 kB     
Downloading: 19 kB     
Downloading: 19 kB     
Downloading: 21 kB     
Downloading: 21 kB     
Downloading: 22 kB     
Downloading: 22 kB     
Downloading: 22 kB     
Downloading: 22 kB     
Downloading: 24 kB     
Downloading: 24 kB     
Downloading: 24 kB     
Downloading: 24 kB     
Downloading: 25 kB     
Downloading: 25 kB     
Downloading: 26 kB     
Downloading: 26 kB     
Downloading: 27 kB     
Downloading: 27 kB     
Downloading: 28 kB     
Downloading: 28 kB     
Downloading: 29 kB     
Downloading: 29 kB     
Downloading: 29 kB     
Downloading: 29 kB     
Downloading: 31 kB     
Downloading: 31 kB     
Downloading: 31 kB     
Downloading: 31 kB     
Downloading: 32 kB     
Downloading: 32 kB     
Downloading: 32 kB     
Downloading: 32 kB     
Downloading: 34 kB     
Downloading: 34 kB     
Downloading: 34 kB     
Downloading: 34 kB     
Downloading: 36 kB     
Downloading: 36 kB     
Downloading: 36 kB     
Downloading: 36 kB     
Downloading: 37 kB     
Downloading: 37 kB     
Downloading: 37 kB     
Downloading: 37 kB     
Downloading: 38 kB     
Downloading: 38 kB     
Downloading: 38 kB     
Downloading: 38 kB     
Downloading: 39 kB     
Downloading: 39 kB     
Downloading: 40 kB     
Downloading: 40 kB     
Downloading: 41 kB     
Downloading: 41 kB     
Downloading: 41 kB     
Downloading: 41 kB     
Downloading: 41 kB     
Downloading: 41 kB     
Downloading: 41 kB     
Downloading: 41 kB</code></pre>
<pre class="r"><code> # age 2 fish: this cohort is sparse and likely departing for the ocean.
 #filter(age != 2) </code></pre>
<div id="coho-lengths-and-weights" class="section level4">
<h4>Coho Lengths and Weights</h4>
<p><br></p>
<pre class="r"><code># create summary table
t_coho &lt;- all_coho %&gt;%
  group_by(river, season, age, spp, year) %&gt;%
  summarise(average_wt = mean(wt_g),
            stdev_wt = sd(wt_g),
            average_len = mean(len_mm),
            stdev_len = sd(len_mm),
            count = n()) %&gt;%
  select(river,season,year,spp,age,count,average_wt,stdev_wt,average_len,stdev_len) %&gt;%
  rename(&quot;_age_&quot; = age)

# print table
t_coho</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["river"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["season"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["year"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["spp"],"name":[4],"type":["chr"],"align":["left"]},{"label":["_age_"],"name":[5],"type":["int"],"align":["right"]},{"label":["count"],"name":[6],"type":["int"],"align":["right"]},{"label":["average_wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["stdev_wt"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["average_len"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["stdev_len"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"Beaver Creek","2":"Early Summer","3":"2015","4":"Coho","5":"0","6":"47","7":"2.600000","8":"0.7416198","9":"63.40426","10":"4.057519"},{"1":"Beaver Creek","2":"Early Summer","3":"2016","4":"Coho","5":"0","6":"30","7":"2.963333","8":"0.6920650","9":"65.70000","10":"4.557298"},{"1":"Beaver Creek","2":"Early Summer","3":"2015","4":"Coho","5":"1","6":"80","7":"5.360000","8":"2.4034574","9":"77.81250","10":"9.287386"},{"1":"Beaver Creek","2":"Early Summer","3":"2016","4":"Coho","5":"1","6":"82","7":"5.104878","8":"2.1929687","9":"76.21951","10":"10.540954"},{"1":"Beaver Creek","2":"Early Summer","3":"2015","4":"Coho","5":"2","6":"12","7":"12.258333","8":"5.3701969","9":"100.58333","10":"14.054817"},{"1":"Beaver Creek","2":"Early Summer","3":"2016","4":"Coho","5":"2","6":"3","7":"16.566667","8":"3.5921210","9":"116.33333","10":"10.785793"},{"1":"Beaver Creek","2":"Mid-Summer","3":"2015","4":"Coho","5":"0","6":"78","7":"2.082051","8":"1.1407156","9":"53.48718","10":"12.083845"},{"1":"Beaver Creek","2":"Mid-Summer","3":"2016","4":"Coho","5":"0","6":"40","7":"3.280000","8":"1.2304262","9":"65.42500","10":"8.601990"},{"1":"Beaver Creek","2":"Mid-Summer","3":"2015","4":"Coho","5":"1","6":"158","7":"5.566456","8":"1.9204767","9":"76.99367","10":"8.064625"},{"1":"Beaver Creek","2":"Mid-Summer","3":"2016","4":"Coho","5":"1","6":"248","7":"6.789516","8":"2.3675375","9":"82.71371","10":"9.296439"},{"1":"Beaver Creek","2":"Mid-Summer","3":"2015","4":"Coho","5":"2","6":"9","7":"7.111111","8":"1.3232955","9":"84.22222","10":"4.437842"},{"1":"Beaver Creek","2":"Mid-Summer","3":"2016","4":"Coho","5":"2","6":"15","7":"10.093333","8":"3.0732641","9":"94.40000","10":"9.402127"},{"1":"Beaver Creek","2":"Late Summer","3":"2015","4":"Coho","5":"0","6":"44","7":"2.272727","8":"1.1797445","9":"55.65909","10":"10.094768"},{"1":"Beaver Creek","2":"Late Summer","3":"2016","4":"Coho","5":"0","6":"34","7":"1.900000","8":"1.1311030","9":"54.29412","10":"9.539485"},{"1":"Beaver Creek","2":"Late Summer","3":"2015","4":"Coho","5":"1","6":"135","7":"6.868148","8":"2.1916617","9":"83.48889","10":"8.309199"},{"1":"Beaver Creek","2":"Late Summer","3":"2016","4":"Coho","5":"1","6":"177","7":"7.742938","8":"2.4432580","9":"86.67232","10":"8.486953"},{"1":"Beaver Creek","2":"Late Summer","3":"2015","4":"Coho","5":"2","6":"16","7":"9.631250","8":"3.2949899","9":"92.18750","10":"9.988118"},{"1":"Beaver Creek","2":"Late Summer","3":"2016","4":"Coho","5":"2","6":"18","7":"10.600000","8":"2.1529733","9":"96.44444","10":"7.406057"},{"1":"Beaver Creek","2":"Fall","3":"2016","4":"Coho","5":"0","6":"128","7":"1.916406","8":"0.6510775","9":"55.18750","10":"6.049338"},{"1":"Beaver Creek","2":"Fall","3":"2016","4":"Coho","5":"1","6":"165","7":"7.441212","8":"2.9934479","9":"85.50909","10":"12.131705"},{"1":"Beaver Creek","2":"Fall","3":"2016","4":"Coho","5":"2","6":"26","7":"11.803846","8":"3.0666569","9":"101.96154","10":"8.344966"},{"1":"Russian River","2":"Early Summer","3":"2015","4":"Coho","5":"0","6":"90","7":"1.587778","8":"0.9623039","9":"47.64444","10":"10.745588"},{"1":"Russian River","2":"Early Summer","3":"2016","4":"Coho","5":"0","6":"41","7":"2.604878","8":"1.0883362","9":"59.34146","10":"9.299489"},{"1":"Russian River","2":"Early Summer","3":"2015","4":"Coho","5":"1","6":"30","7":"4.776667","8":"1.6329967","9":"72.10000","10":"8.376280"},{"1":"Russian River","2":"Early Summer","3":"2016","4":"Coho","5":"1","6":"68","7":"4.736765","8":"1.6250745","9":"74.26471","10":"7.226852"},{"1":"Russian River","2":"Early Summer","3":"2015","4":"Coho","5":"2","6":"2","7":"8.200000","8":"6.9296465","9":"83.50000","10":"24.748737"},{"1":"Russian River","2":"Early Summer","3":"2016","4":"Coho","5":"2","6":"1","7":"17.100000","8":"NA","9":"115.00000","10":"NA"},{"1":"Russian River","2":"Mid-Summer","3":"2015","4":"Coho","5":"0","6":"139","7":"1.425180","8":"0.6468534","9":"49.69065","10":"6.108736"},{"1":"Russian River","2":"Mid-Summer","3":"2016","4":"Coho","5":"0","6":"169","7":"1.541420","8":"0.5298813","9":"51.50888","10":"5.758140"},{"1":"Russian River","2":"Mid-Summer","3":"2015","4":"Coho","5":"1","6":"10","7":"5.340000","8":"3.2633316","9":"76.20000","10":"15.061356"},{"1":"Russian River","2":"Mid-Summer","3":"2016","4":"Coho","5":"1","6":"33","7":"7.712121","8":"3.3035736","9":"85.60606","10":"13.548384"},{"1":"Russian River","2":"Mid-Summer","3":"2015","4":"Coho","5":"2","6":"4","7":"8.525000","8":"3.3119732","9":"92.50000","10":"11.328430"},{"1":"Russian River","2":"Mid-Summer","3":"2016","4":"Coho","5":"2","6":"3","7":"12.933333","8":"5.6659804","9":"103.33333","10":"18.475209"},{"1":"Russian River","2":"Late Summer","3":"2015","4":"Coho","5":"0","6":"144","7":"1.851389","8":"0.8474549","9":"53.84028","10":"7.551838"},{"1":"Russian River","2":"Late Summer","3":"2016","4":"Coho","5":"0","6":"162","7":"2.081481","8":"0.6877113","9":"56.37037","10":"5.936401"},{"1":"Russian River","2":"Late Summer","3":"2015","4":"Coho","5":"1","6":"25","7":"3.220000","8":"2.0116328","9":"64.48000","10":"9.478572"},{"1":"Russian River","2":"Late Summer","3":"2016","4":"Coho","5":"1","6":"62","7":"5.580645","8":"2.7591778","9":"78.06452","10":"13.598301"},{"1":"Russian River","2":"Late Summer","3":"2015","4":"Coho","5":"2","6":"7","7":"10.114286","8":"0.7840675","9":"96.85714","10":"2.478479"},{"1":"Russian River","2":"Late Summer","3":"2016","4":"Coho","5":"2","6":"1","7":"6.200000","8":"NA","9":"84.00000","10":"NA"},{"1":"Russian River","2":"Fall","3":"2016","4":"Coho","5":"0","6":"78","7":"1.902564","8":"0.6939393","9":"54.96154","10":"6.366394"},{"1":"Russian River","2":"Fall","3":"2016","4":"Coho","5":"1","6":"10","7":"3.640000","8":"1.4668182","9":"69.70000","10":"8.124722"},{"1":"Ptarmigan Creek","2":"Early Summer","3":"2015","4":"Coho","5":"0","6":"11","7":"2.763636","8":"0.9211653","9":"61.36364","10":"7.788103"},{"1":"Ptarmigan Creek","2":"Early Summer","3":"2016","4":"Coho","5":"0","6":"4","7":"3.750000","8":"0.2380476","9":"68.25000","10":"2.362908"},{"1":"Ptarmigan Creek","2":"Early Summer","3":"2015","4":"Coho","5":"1","6":"57","7":"5.668421","8":"2.4647629","9":"77.98246","10":"10.184882"},{"1":"Ptarmigan Creek","2":"Early Summer","3":"2016","4":"Coho","5":"1","6":"7","7":"5.500000","8":"2.4779023","9":"77.00000","10":"11.944315"},{"1":"Ptarmigan Creek","2":"Early Summer","3":"2015","4":"Coho","5":"2","6":"1","7":"11.100000","8":"NA","9":"100.00000","10":"NA"},{"1":"Ptarmigan Creek","2":"Mid-Summer","3":"2015","4":"Coho","5":"0","6":"11","7":"2.772727","8":"1.0798990","9":"62.45455","10":"8.358991"},{"1":"Ptarmigan Creek","2":"Mid-Summer","3":"2016","4":"Coho","5":"0","6":"7","7":"4.042857","8":"1.0064080","9":"69.42857","10":"3.690399"},{"1":"Ptarmigan Creek","2":"Mid-Summer","3":"2015","4":"Coho","5":"1","6":"73","7":"5.534247","8":"1.7263657","9":"78.47945","10":"7.701208"},{"1":"Ptarmigan Creek","2":"Mid-Summer","3":"2016","4":"Coho","5":"1","6":"36","7":"6.086111","8":"2.1070159","9":"80.80556","10":"9.170822"},{"1":"Ptarmigan Creek","2":"Mid-Summer","3":"2016","4":"Coho","5":"2","6":"3","7":"11.633333","8":"1.7616280","9":"103.00000","10":"6.244998"},{"1":"Ptarmigan Creek","2":"Late Summer","3":"2015","4":"Coho","5":"0","6":"22","7":"2.518182","8":"0.9926570","9":"60.36364","10":"8.660504"},{"1":"Ptarmigan Creek","2":"Late Summer","3":"2016","4":"Coho","5":"0","6":"14","7":"3.478571","8":"1.1314923","9":"66.42857","10":"7.078834"},{"1":"Ptarmigan Creek","2":"Late Summer","3":"2015","4":"Coho","5":"1","6":"59","7":"5.540678","8":"1.8706553","9":"78.62712","10":"9.486648"},{"1":"Ptarmigan Creek","2":"Late Summer","3":"2016","4":"Coho","5":"1","6":"70","7":"7.220000","8":"2.6039324","9":"86.01429","10":"9.967328"},{"1":"Ptarmigan Creek","2":"Late Summer","3":"2015","4":"Coho","5":"2","6":"10","7":"10.980000","8":"1.5746605","9":"101.30000","10":"5.437524"},{"1":"Ptarmigan Creek","2":"Late Summer","3":"2016","4":"Coho","5":"2","6":"13","7":"11.569231","8":"2.0282935","9":"99.84615","10":"5.843032"},{"1":"Ptarmigan Creek","2":"Fall","3":"2016","4":"Coho","5":"0","6":"20","7":"2.360000","8":"0.6003508","9":"60.20000","10":"4.162489"},{"1":"Ptarmigan Creek","2":"Fall","3":"2016","4":"Coho","5":"1","6":"10","7":"4.370000","8":"1.3638589","9":"74.30000","10":"8.327331"},{"1":"Kenai River","2":"Early Summer","3":"2015","4":"Coho","5":"0","6":"1","7":"1.900000","8":"NA","9":"55.00000","10":"NA"},{"1":"Kenai River","2":"Early Summer","3":"2016","4":"Coho","5":"0","6":"2","7":"3.750000","8":"1.0606602","9":"68.50000","10":"9.192388"},{"1":"Kenai River","2":"Early Summer","3":"2016","4":"Coho","5":"1","6":"1","7":"5.300000","8":"NA","9":"72.00000","10":"NA"},{"1":"Kenai River","2":"Early Summer","3":"2016","4":"Coho","5":"2","6":"1","7":"22.800000","8":"NA","9":"132.00000","10":"NA"},{"1":"Kenai River","2":"Mid-Summer","3":"2015","4":"Coho","5":"0","6":"30","7":"1.213333","8":"0.3794127","9":"46.36667","10":"4.021351"},{"1":"Kenai River","2":"Mid-Summer","3":"2015","4":"Coho","5":"1","6":"2","7":"5.700000","8":"1.6970563","9":"78.50000","10":"9.192388"},{"1":"Kenai River","2":"Late Summer","3":"2015","4":"Coho","5":"0","6":"130","7":"1.362308","8":"0.4342445","9":"48.26154","10":"4.455732"},{"1":"Kenai River","2":"Late Summer","3":"2016","4":"Coho","5":"0","6":"18","7":"1.344444","8":"0.7755243","9":"47.33333","10":"8.196125"},{"1":"Kenai River","2":"Late Summer","3":"2016","4":"Coho","5":"1","6":"3","7":"6.733333","8":"1.0214369","9":"85.00000","10":"1.000000"},{"1":"Kenai River","2":"Late Summer","3":"2015","4":"Coho","5":"2","6":"1","7":"11.600000","8":"NA","9":"104.00000","10":"NA"},{"1":"Kenai River","2":"Fall","3":"2016","4":"Coho","5":"0","6":"73","7":"1.236986","8":"0.4894744","9":"47.98630","10":"5.116675"},{"1":"Kenai River","2":"Fall","3":"2016","4":"Coho","5":"1","6":"3","7":"1.766667","8":"0.1154701","9":"57.00000","10":"1.732051"},{"1":"Kenai River","2":"Fall","3":"2016","4":"Coho","5":"2","6":"1","7":"9.700000","8":"NA","9":"96.00000","10":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[4],"max":[4]},"pages":{}}}
  </script>
</div>
<p><strong>Table X -</strong> Coho length and weight data summary.</p>
<p><br></p>
<p>NOTE: Probably not useful to examine growth trends for Age 2 Coho because they are most likely all smolting out and departing for the marine environment. Included here for display interest.</p>
<p><br></p>
<div id="coho-lengths" class="section level5">
<h5>Coho Lengths</h5>
<pre class="r"><code># Coho lengths
p0 &lt;- ggplot(all_coho, aes(season,len_mm, fill = as.factor(age))) +
  geom_boxplot(outlier.size = 0) +
  geom_point(pch = 21, position = position_jitterdodge()) +
  facet_grid(year~river) +
  xlab(&quot;Season&quot;) +
  ylab(&quot;Length (mm)&quot;) +
  ggtitle(&quot;Juvenile Coho Lengths&quot;) +
  theme_bw() +
  bm_theme +
  # legend
  scale_fill_discrete(name=&quot;Age&quot;) +
  theme(legend.background = element_rect(fill=&quot;gray90&quot;, size=.5, linetype=&quot;dotted&quot;)) 
p0</code></pre>
<div class="figure">
<img src="create_size_input_mkdown_files/figure-html/plot%20boxplot%20coho%20lengths-1.png" alt="**Figure X -** Boxplots of juvenile Coho fork lengths by season, for each year and drainage." width="960" />
<p class="caption">
<strong>Figure X -</strong> Boxplots of juvenile Coho fork lengths by season, for each year and drainage.
</p>
</div>
<hr />
<p><br></p>
</div>
<div id="coho-weights" class="section level5">
<h5>Coho Weights</h5>
<pre class="r"><code>p1 &lt;- ggplot(all_coho, aes(season,wt_g, fill = as.factor(age))) +
  geom_boxplot(outlier.size = 0) +
  geom_point(pch = 21, position = position_jitterdodge()) +
  facet_grid(year~river) +
  xlab(&quot;Season&quot;) +
  ylab(&quot;Weight (g)&quot;) +
  ggtitle(&quot;Juvenile Coho Weights&quot;) +
  theme_bw() +
  bm_theme +
  # legend
  scale_fill_discrete(name=&quot;Age&quot;) 
p1</code></pre>
<div class="figure">
<img src="create_size_input_mkdown_files/figure-html/plot%20boxplot%20coho%20weights-1.png" alt="**Figure X -** Boxplots of juvenile Coho weights by season, for each year and drainage." width="960" />
<p class="caption">
<strong>Figure X -</strong> Boxplots of juvenile Coho weights by season, for each year and drainage.
</p>
</div>
<hr />
<p><br></p>
<pre class="r"><code># temporarily load plyr package
library(plyr)

# choose formula style for plotting
formula &lt;- y ~ x

# Correct Facet Labels
age_facets &lt;- c(
  `0` = &quot;Age 0&quot;,
  `1` = &quot;Age 1&quot;,
  `2` = &quot;Age 2&quot;
  )

river_facets &lt;- c(
  `Beaver Creek` = &quot;Beaver Creek&quot;,
  `Russian River` = &quot;Russian River&quot;,
  `Ptarmigan Creek` = &quot;Ptarmigan Creek&quot;,
  `Kenai River` = &quot;Kenai River&quot;
  )

# specify format for formula and r2 labels in LENGTH plots    
len_formula_labels &lt;- stat_poly_eq(aes(label = paste(&quot;atop(&quot;,..eq.label.., &quot;,&quot;, ..adj.rr.label.., &quot;)&quot;, sep = &quot;&quot;)),
               formula = formula, 
               rr.digits = 2, 
               coef.digits = 2, 
               parse = TRUE,
               label.y = 110, 
               size = 3,
               geom = &quot;label&quot;, 
               alpha = 0.8) 

# calculate n values
coho.cor &lt;- ddply(.data=all_coho, 
                 .(age, river), 
                 summarize, 
                 n=paste(&quot;n =&quot;, length(sample.event)))

# unload plyr package
detach(package:plyr)

# Coho LENGTH date vs. age facets
axl &lt;- ggplot(data = all_coho, aes(x = doy, y = len_mm)) +
  facet_grid(age ~ river, labeller = labeller(age = as_labeller(age_facets),
                                                 river = as_labeller(river_facets))) +
  geom_jitter(width = 0.4, aes(color = Hydrologic.Segment)) +
  geom_smooth(method = lm, color = &quot;black&quot;, se = F) +
  xlab(&quot;Day of Year&quot;) +
  ylab(&quot;Fork Length (mm)&quot;) +
  ylim(c(15, NA)) +
  len_formula_labels +
  # n labels
    geom_text(data=coho.cor, aes(x=165, y=30, label=n), 
            colour=&quot;black&quot;, inherit.aes=FALSE, parse=FALSE, fontface = &quot;bold&quot;) +
  theme_bw() +
  bm_theme
    
# 2015 coho lengths
axl %+% subset(all_coho, year %in% c(&quot;2015&quot;)) +
  ggtitle(&quot;2015 Coho Lengths&quot;)</code></pre>
<div class="figure">
<img src="create_size_input_mkdown_files/figure-html/plot%202015%20date%20vs%20age%20facets%20for%20coho%20length-1.png" alt="**Figure X -** 2015 Coho length vs. day of year.  Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported." width="960" />
<p class="caption">
<strong>Figure X -</strong> 2015 Coho length vs. day of year. Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported.
</p>
</div>
<hr />
<p><br></p>
<pre class="r"><code># 2016 coho lengths
axl %+% subset(all_coho, year %in% c(&quot;2016&quot;)) +
  ggtitle(&quot;2016 Coho Lengths&quot;)</code></pre>
<div class="figure">
<img src="create_size_input_mkdown_files/figure-html/plot%202016%20date%20vs%20age%20facets%20for%20coho%20length-1.png" alt="**Figure X -** 2016 Coho length vs. day of year.  Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported." width="960" />
<p class="caption">
<strong>Figure X -</strong> 2016 Coho length vs. day of year. Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported.
</p>
</div>
<hr />
<p><br></p>
<pre class="r"><code># specify format for formula and r2 labels in WEIGHT plots    
wt_formula_labels &lt;- stat_poly_eq(aes(label = paste(&quot;atop(&quot;,..eq.label.., &quot;,&quot;, ..adj.rr.label.., &quot;)&quot;, sep = &quot;&quot;)),
               formula = formula, 
               rr.digits = 2, 
               coef.digits = 2, 
               parse = TRUE,
               label.y = 20, 
               size = 3,
               geom = &quot;label&quot;, 
               alpha = 0.8)


# Coho WEIGHT date vs. age facets
axw &lt;- ggplot(data = all_coho, aes(x = doy, y = wt_g)) +
  facet_grid(age ~ river, labeller = labeller(age = as_labeller(age_facets),
                                                 river = as_labeller(river_facets))) +
  geom_jitter(width = 0.4, aes(color = Hydrologic.Segment)) +
  geom_smooth(method = lm, color = &quot;black&quot;, se = F) +
  xlab(&quot;Day of Year&quot;) +
  ylab(&quot;Weight (g)&quot;) +
  #ylim(c(15, NA)) +
  wt_formula_labels +
  # n labels
    geom_text(data=coho.cor, aes(x=165, y=5, label=n), 
            colour=&quot;black&quot;, inherit.aes=FALSE, parse=FALSE, fontface = &quot;bold&quot;) +
  theme_bw() +
  bm_theme
    
# 2015 coho weights
axw %+% subset(all_coho, year %in% c(&quot;2015&quot;)) +
  ggtitle(&quot;2015 Coho Weights&quot;)</code></pre>
<div class="figure">
<img src="create_size_input_mkdown_files/figure-html/plot%202015%20date%20vs%20age%20facets%20for%20coho%20weight-1.png" alt="**Figure X -** 2015 Coho weight vs. day of year.  Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported." width="960" />
<p class="caption">
<strong>Figure X -</strong> 2015 Coho weight vs. day of year. Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported.
</p>
</div>
<hr />
<p><br></p>
<pre class="r"><code># 2016 coho weights
axw %+% subset(all_coho, year %in% c(&quot;2016&quot;)) +
  ggtitle(&quot;2016 Coho Weights&quot;)</code></pre>
<div class="figure">
<img src="create_size_input_mkdown_files/figure-html/plot%202016%20date%20vs%20age%20facets%20for%20coho%20weight-1.png" alt="**Figure X -** 2016 Coho weight vs. day of year.  Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported." width="960" />
<p class="caption">
<strong>Figure X -</strong> 2016 Coho weight vs. day of year. Each iteration of fish age and drainage is fitted with a linear relationship, with formula and adjusted r^2 value reported.
</p>
</div>
<p><br></p>
<hr />
<hr />
<p><br></p>
<p><strong>Tests for annual differences in size distribution.</strong> Question: Do significant differences exist in size-at-age between 2015 and 2016 coho? If the size-at-age patterns are similar between the two years, it could be possible to pool data between the two years to increase sample size. If not, consider the annual datasets seperately.</p>
<p><br></p>
<pre class="r"><code>
# All Coho OVERALL, all drainages
mod1 &lt;- multinom(age~len_mm,data=all_coho,maxit=500)
mod2 &lt;- multinom(age~len_mm*year,data=all_coho,maxit=500)
z&lt;-anova(mod1,mod2)

p_all_coho &lt;- paste0(&quot;p=&quot;,signif(as.numeric(z$`Pr(Chi)`[2]), digits = 3))</code></pre>
<p><strong>Overall (all drainages pooled):</strong> Do significant differences exist in 2015 vs 2015 Coho fork length distribution, at the overall (all drainages) level? (YES, p=0.000119, ANOVA.)</p>
<pre class="r"><code>
# 2015 vs 2016 Beaver Creek ALK
bc_coho &lt;- subset(all_coho, river %in% c(&quot;Beaver Creek&quot;)) 

# All Coho Beaver Creek
mod1 &lt;- multinom(age~len_mm,data=bc_coho,maxit=500)
mod2 &lt;- multinom(age~len_mm*year,data=bc_coho,maxit=500)
z &lt;- anova(mod1,mod2)

p_bc_coho &lt;- paste0(&quot;p=&quot;,signif(as.numeric(z$`Pr(Chi)`[2]), digits = 3))</code></pre>
<p><strong>Beaver Creek:</strong> Do significant differences exist in 2015 vs 2015 Coho fork length distribution, at the Beaver Creek level? (YES, p=1.03e-09, ANOVA)</p>
<pre class="r"><code>
# 2015 vs 2016 Russian River ALK
rr_coho &lt;- subset(all_coho, river %in% c(&quot;Russian River&quot;)) 

# All Coho Russian River
mod1 &lt;- multinom(age~len_mm,data=bc_coho,maxit=500)
mod2 &lt;- multinom(age~len_mm*year,data=bc_coho,maxit=500)
z &lt;- anova(mod1,mod2)

z&lt;-anova(mod1,mod2)

p_rr_coho &lt;- paste0(&quot;p=&quot;,signif(as.numeric(z$`Pr(Chi)`[2]), digits = 3))</code></pre>
<p><strong>Russian River:</strong> Do significant differences exist in 2015 vs 2015 Coho fork length distribution, at the Russian River level? (YES, p=1.03e-09, ANOVA)</p>
<pre class="r"><code>
# 2015 vs 2016 Ptarmigan Creek ALK
pc_coho &lt;- subset(all_coho, river %in% c(&quot;Ptarmigan Creek&quot;)) 

# All Coho Ptarmigan Creek
mod1 &lt;- multinom(age~len_mm,data=pc_coho,maxit=500)
mod2 &lt;- multinom(age~len_mm*year,data=pc_coho,maxit=500)
z &lt;- anova(mod1,mod2)

z&lt;-anova(mod1,mod2)

p_pc_coho &lt;- paste0(&quot;p=&quot;,signif(as.numeric(z$`Pr(Chi)`[2]), digits = 3))</code></pre>
<p><strong>Ptarmigan Creek:</strong> Do significant differences exist in 2015 vs 2015 Coho fork length distribution, at the Russian River level? (NO, p=0.013, ANOVA)</p>
<pre class="r"><code>
# 2015 vs 2016 Kenai River ALK
kr_coho &lt;- subset(all_coho, river %in% c(&quot;Kenai River&quot;)) 

# All Coho Kenai River
mod1 &lt;- multinom(age~len_mm,data=kr_coho,maxit=500)
mod2 &lt;- multinom(age~len_mm*year,data=kr_coho,maxit=500)
z &lt;- anova(mod1,mod2)

z&lt;-anova(mod1,mod2)

p_kr_coho &lt;- paste0(&quot;p=&quot;,signif(as.numeric(z$`Pr(Chi)`[2]), digits = 3))</code></pre>
<p><strong>Kenai River:</strong> Do significant differences exist in 2015 vs 2015 Coho fork length distribution, at the Kenai River level? (NO, p=0.248, ANOVA)</p>
<p><br></p>
<p><strong>Discussion, 2015 vs 2016 fork length distribution:</strong> Evidence generally supports that</p>
<p><strong>Comments on Coho size distriution analysis:</strong> Blah blah</p>
<pre class="r"><code># test, in devpt -- VBF relationships?

# mod_age1 &lt;- multinom(season~lcat5*age,data=all_coho,maxit=500)</code></pre>
<hr />
<hr />
<p><br></p>
</div>
</div>
<div id="chinook-lengths-and-weights" class="section level4">
<h4>Chinook Lengths and Weights</h4>
<div id="chinook-size-summary-values" class="section level5">
<h5>Chinook size summary values</h5>
<pre class="r"><code># create summary table
t_chnk &lt;- all_chnk %&gt;%
  group_by(river, season, age, spp,year) %&gt;%
  summarise(average_wt = mean(wt_g),
            stdev_wt = sd(wt_g),
            average_len = mean(len_mm),
            stdev_len = sd(len_mm),
            count = n()) %&gt;%
  select(river,year,season,spp,age,count,average_wt,stdev_wt,average_len,stdev_len) %&gt;%
  rename(&quot;_age_&quot; = age)

# print table
t_chnk</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["river"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["year"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["season"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["spp"],"name":[4],"type":["chr"],"align":["left"]},{"label":["_age_"],"name":[5],"type":["int"],"align":["right"]},{"label":["count"],"name":[6],"type":["int"],"align":["right"]},{"label":["average_wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["stdev_wt"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["average_len"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["stdev_len"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"Beaver Creek","2":"2015","3":"Early Summer","4":"Chinook","5":"0","6":"2","7":"3.700000","8":"0.0000000","9":"60.00000","10":"0.000000"},{"1":"Beaver Creek","2":"2015","3":"Early Summer","4":"Chinook","5":"1","6":"6","7":"5.500000","8":"1.4057027","9":"78.33333","10":"6.831301"},{"1":"Beaver Creek","2":"2015","3":"Mid-Summer","4":"Chinook","5":"0","6":"2","7":"2.000000","8":"0.0000000","9":"54.00000","10":"0.000000"},{"1":"Beaver Creek","2":"2016","3":"Mid-Summer","4":"Chinook","5":"0","6":"85","7":"1.469412","8":"0.3940098","9":"50.44706","10":"4.078124"},{"1":"Beaver Creek","2":"2016","3":"Late Summer","4":"Chinook","5":"0","6":"80","7":"2.051250","8":"0.7609111","9":"55.71250","10":"6.146304"},{"1":"Beaver Creek","2":"2015","3":"Late Summer","4":"Chinook","5":"1","6":"1","7":"3.200000","8":"NA","9":"64.00000","10":"NA"},{"1":"Beaver Creek","2":"2016","3":"Late Summer","4":"Chinook","5":"1","6":"5","7":"5.220000","8":"2.1076053","9":"75.80000","10":"9.257429"},{"1":"Beaver Creek","2":"2016","3":"Fall","4":"Chinook","5":"0","6":"33","7":"2.418182","8":"0.7875812","9":"58.54545","10":"6.514843"},{"1":"Beaver Creek","2":"2016","3":"Fall","4":"Chinook","5":"1","6":"1","7":"4.700000","8":"NA","9":"78.00000","10":"NA"},{"1":"Russian River","2":"2015","3":"Early Summer","4":"Chinook","5":"0","6":"23","7":"1.443478","8":"0.2408811","9":"47.56522","10":"2.873485"},{"1":"Russian River","2":"2016","3":"Early Summer","4":"Chinook","5":"0","6":"37","7":"1.451351","8":"0.5310480","9":"49.70270","10":"4.982552"},{"1":"Russian River","2":"2015","3":"Mid-Summer","4":"Chinook","5":"0","6":"5","7":"2.260000","8":"0.8763561","9":"57.00000","10":"7.778175"},{"1":"Russian River","2":"2016","3":"Mid-Summer","4":"Chinook","5":"0","6":"23","7":"3.591304","8":"1.3259347","9":"67.34783","10":"7.119810"},{"1":"Russian River","2":"2016","3":"Mid-Summer","4":"Chinook","5":"1","6":"1","7":"5.000000","8":"NA","9":"78.00000","10":"NA"},{"1":"Russian River","2":"2016","3":"Late Summer","4":"Chinook","5":"0","6":"6","7":"3.916667","8":"1.3644291","9":"69.00000","10":"6.870226"},{"1":"Russian River","2":"2016","3":"Fall","4":"Chinook","5":"0","6":"5","7":"3.080000","8":"1.2617448","9":"64.20000","10":"9.523655"},{"1":"Russian River","2":"2016","3":"Fall","4":"Chinook","5":"1","6":"3","7":"4.733333","8":"1.1718931","9":"74.66667","10":"5.507571"},{"1":"Ptarmigan Creek","2":"2015","3":"Early Summer","4":"Chinook","5":"0","6":"3","7":"1.833333","8":"0.2309401","9":"55.00000","10":"1.732051"},{"1":"Ptarmigan Creek","2":"2015","3":"Mid-Summer","4":"Chinook","5":"0","6":"9","7":"3.300000","8":"0.6244998","9":"66.66667","10":"5.634714"},{"1":"Ptarmigan Creek","2":"2016","3":"Mid-Summer","4":"Chinook","5":"0","6":"3","7":"3.233333","8":"0.9291573","9":"65.66667","10":"4.725816"},{"1":"Ptarmigan Creek","2":"2015","3":"Mid-Summer","4":"Chinook","5":"1","6":"1","7":"1.800000","8":"NA","9":"54.00000","10":"NA"},{"1":"Ptarmigan Creek","2":"2015","3":"Late Summer","4":"Chinook","5":"0","6":"3","7":"2.566667","8":"0.5131601","9":"63.00000","10":"3.464102"},{"1":"Ptarmigan Creek","2":"2016","3":"Late Summer","4":"Chinook","5":"0","6":"13","7":"4.230769","8":"1.0152049","9":"71.92308","10":"5.574668"},{"1":"Ptarmigan Creek","2":"2015","3":"Late Summer","4":"Chinook","5":"1","6":"1","7":"8.200000","8":"NA","9":"90.00000","10":"NA"},{"1":"Ptarmigan Creek","2":"2016","3":"Late Summer","4":"Chinook","5":"1","6":"11","7":"5.709091","8":"0.6714976","9":"79.90909","10":"3.048099"},{"1":"Ptarmigan Creek","2":"2016","3":"Fall","4":"Chinook","5":"0","6":"1","7":"3.100000","8":"NA","9":"67.00000","10":"NA"},{"1":"Kenai River","2":"2015","3":"Early Summer","4":"Chinook","5":"0","6":"64","7":"1.276563","8":"0.4154715","9":"48.28125","10":"4.303814"},{"1":"Kenai River","2":"2016","3":"Early Summer","4":"Chinook","5":"0","6":"58","7":"1.129310","8":"0.4991251","9":"46.41379","10":"5.153893"},{"1":"Kenai River","2":"2016","3":"Early Summer","4":"Chinook","5":"1","6":"2","7":"3.500000","8":"0.9899495","9":"69.00000","10":"7.071068"},{"1":"Kenai River","2":"2015","3":"Mid-Summer","4":"Chinook","5":"0","6":"37","7":"1.932432","8":"0.9122786","9":"53.62162","10":"7.945479"},{"1":"Kenai River","2":"2016","3":"Mid-Summer","4":"Chinook","5":"0","6":"252","7":"1.738095","8":"0.6264244","9":"53.35714","10":"5.326719"},{"1":"Kenai River","2":"2015","3":"Mid-Summer","4":"Chinook","5":"1","6":"1","7":"3.700000","8":"NA","9":"69.00000","10":"NA"},{"1":"Kenai River","2":"2016","3":"Mid-Summer","4":"Chinook","5":"1","6":"2","7":"3.050000","8":"0.3535534","9":"62.50000","10":"3.535534"},{"1":"Kenai River","2":"2015","3":"Late Summer","4":"Chinook","5":"0","6":"6","7":"2.516667","8":"1.0303721","9":"58.66667","10":"9.852242"},{"1":"Kenai River","2":"2016","3":"Late Summer","4":"Chinook","5":"0","6":"214","7":"2.241589","8":"0.8242221","9":"57.59346","10":"6.723804"},{"1":"Kenai River","2":"2016","3":"Late Summer","4":"Chinook","5":"1","6":"9","7":"3.977778","8":"1.0317192","9":"69.66667","10":"5.852350"},{"1":"Kenai River","2":"2016","3":"Fall","4":"Chinook","5":"0","6":"141","7":"2.980142","8":"1.1803885","9":"63.06383","10":"8.202101"},{"1":"Kenai River","2":"2016","3":"Fall","4":"Chinook","5":"1","6":"17","7":"4.494118","8":"1.3934986","9":"72.64706","10":"7.061703"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[4],"max":[4]},"pages":{}}}
  </script>
</div>
<p>NOTE: Probably not useful to examine growth trends for Age 1 Chinook because they are most likely all smolting out and departing for the marine environment. Included here for display interest.</p>
<p><br></p>
</div>
<div id="chinook-lengths" class="section level5">
<h5>Chinook lengths</h5>
<pre class="r"><code># Chinook lengths
p2 &lt;- ggplot(all_chnk, aes(season,len_mm, fill = as.factor(age))) +
  geom_boxplot(outlier.size = 0) +
  geom_point(pch = 21, position = position_jitterdodge()) +
  facet_grid(year~river) +
  xlab(&quot;Season&quot;) +
  ylab(&quot;Length (mm)&quot;) +
  ggtitle(&quot;Juvenile Chinook Lengths&quot;) +
  theme_bw() +
  bm_theme +
  # legend
  scale_fill_discrete(name=&quot;Age&quot;) +
  theme(legend.background = element_rect(fill=&quot;gray90&quot;, size=.5, linetype=&quot;dotted&quot;)) 
p2</code></pre>
<p><img src="create_size_input_mkdown_files/figure-html/plot%20chinook%20lengths-1.png" width="960" /></p>
</div>
<div id="chinook-weights" class="section level5">
<h5>Chinook Weights</h5>
<pre class="r"><code># Chinook weights
p3 &lt;- ggplot(all_chnk, aes(season,wt_g, fill = as.factor(age))) +
  geom_boxplot(outlier.size = 0) +
  geom_point(pch = 21, position = position_jitterdodge()) +
  facet_grid(year~river) +
  xlab(&quot;Season&quot;) +
  ylab(&quot;Weight (g)&quot;) +
  ggtitle(&quot;Juvenile Chinook Weights&quot;) +
  theme_bw() +
  bm_theme +
  # legend
  scale_fill_discrete(name=&quot;Age&quot;) +
  theme(legend.background = element_rect(fill=&quot;gray90&quot;, size=.5, linetype=&quot;dotted&quot;)) 
p3</code></pre>
<p><img src="create_size_input_mkdown_files/figure-html/plot%20chinook%20weights-1.png" width="960" /></p>
</div>
<div id="question-could-growth-inputs-for-bioenergetics-somehow-be-generated-though-a-von-bertellanfy-relationship" class="section level5">
<h5>[Question: could growth inputs for bioenergetics somehow be generated though a von bertellanfy relationship?! ]</h5>
<p><br></p>
<p><br></p>
</div>
<div id="a.-test-for-significant-difference-among-seasons-for-each-sppyear.-kruskall-wallis-nonparametric." class="section level5">
<h5>a.) Test for significant difference among seasons for each spp/year. (Kruskall-wallis, nonparametric).</h5>
</div>
<div id="b.-if-not-consistent-test-for-differences-between-years-for-each-sppriver.-if-not-sigfnificant-consider-combining-years.-question-would-this-mean-re-doing-age-length-keys" class="section level5">
<h5>b.) If not consistent, test for differences between years for each spp/river. If not sigfnificant, consider combining years. (Question: Would this mean re-doing Age-Length Keys?)</h5>
<p><br></p>
</div>
<div id="question" class="section level5">
<h5>QUESTION</h5>
<div id="using-the-alk-assigned-ages-can-the-case-be-made-for-combining-the-datasets-by-year" class="section level6">
<h6>Using the ALK-assigned ages, can the case be made for combining the datasets by year?</h6>
<pre class="r"><code># prepare dataset 
all_coho &lt;- all_coho %&gt;%
  transform(year = as.character(year),
            age = as.numeric(age),
            lcat5 = as.numeric(lcat5))

# For each species/river, does the overall relationship between length and age 
# differ by YEAR ??

# All Coho (NO, p = 0.38)
mod1 &lt;- multinom(age~lcat5,data=all_coho,maxit=500)</code></pre>
<pre><code>## # weights:  9 (4 variable)
## initial  value 3645.195574 
## iter  10 value 999.452970
## final  value 990.662980 
## converged</code></pre>
<pre class="r"><code>mod2 &lt;- multinom(age~lcat5*year,data=all_coho,maxit=500)</code></pre>
<pre><code>## # weights:  15 (8 variable)
## initial  value 3645.195574 
## iter  10 value 1173.663345
## iter  20 value 979.852732
## iter  30 value 978.978795
## iter  30 value 978.978790
## iter  30 value 978.978790
## final  value 978.978790 
## converged</code></pre>
<pre class="r"><code>anova(mod1,mod2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Model"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Resid. df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Test"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["   Df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["LR stat."],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Pr(Chi)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"lcat5","2":"6632","3":"1981.326","4":"","5":"NA","6":"NA","7":"NA"},{"1":"lcat5 * year","2":"6628","3":"1957.958","4":"1 vs 2","5":"4","6":"23.36838","7":"0.0001068768"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Beaver Creek Coho (YES, p = 0.18e-05)
all_coho_bc &lt;- all_coho %&gt;%
  filter(river == &quot;Beaver Creek&quot;)
mod1 &lt;- multinom(age~lcat5,data=all_coho_bc,maxit=500)</code></pre>
<pre><code>## # weights:  9 (4 variable)
## initial  value 1697.355986 
## iter  10 value 533.789978
## final  value 530.860875 
## converged</code></pre>
<pre class="r"><code>mod2 &lt;- multinom(age~lcat5*year,data=all_coho_bc,maxit=500)</code></pre>
<pre><code>## # weights:  15 (8 variable)
## initial  value 1697.355986 
## iter  10 value 558.260148
## iter  20 value 507.031702
## iter  30 value 505.813130
## final  value 505.714338 
## converged</code></pre>
<pre class="r"><code>anova(mod1,mod2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Model"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Resid. df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Test"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["   Df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["LR stat."],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Pr(Chi)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"lcat5","2":"3086","3":"1061.722","4":"","5":"NA","6":"NA","7":"NA"},{"1":"lcat5 * year","2":"3082","3":"1011.429","4":"1 vs 2","5":"4","6":"50.29307","7":"3.13626e-10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Russian River Coho (YES, p = 0.001)
all_coho_rr &lt;- all_coho %&gt;%
  filter(river == &quot;Russian River&quot;)
mod1 &lt;- multinom(age~lcat5,data=all_coho_rr,maxit=500)</code></pre>
<pre><code>## # weights:  9 (4 variable)
## initial  value 1185.402659 
## iter  10 value 281.038077
## final  value 273.949347 
## converged</code></pre>
<pre class="r"><code>mod2 &lt;- multinom(age~lcat5*year,data=all_coho_rr,maxit=500)</code></pre>
<pre><code>## # weights:  15 (8 variable)
## initial  value 1185.402659 
## iter  10 value 285.096407
## iter  20 value 256.810500
## iter  30 value 254.358849
## final  value 254.357249 
## converged</code></pre>
<pre class="r"><code>anova(mod1,mod2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Model"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Resid. df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Test"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["   Df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["LR stat."],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Pr(Chi)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"lcat5","2":"2154","3":"547.8987","4":"","5":"NA","6":"NA","7":"NA"},{"1":"lcat5 * year","2":"2150","3":"508.7145","4":"1 vs 2","5":"4","6":"39.1842","7":"6.38205e-08"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Ptarmigan Creek Coho (YES, p = 0.04)
all_coho_pc &lt;- all_coho %&gt;%
  filter(river == &quot;Ptarmigan Creek&quot;)
mod1 &lt;- multinom(age~lcat5,data=all_coho_pc,maxit=500)</code></pre>
<pre><code>## # weights:  9 (4 variable)
## initial  value 470.206060 
## iter  10 value 155.610918
## iter  20 value 154.983550
## iter  20 value 154.983549
## iter  20 value 154.983549
## final  value 154.983549 
## converged</code></pre>
<pre class="r"><code>mod2 &lt;- multinom(age~lcat5*year,data=all_coho_pc,maxit=500)</code></pre>
<pre><code>## # weights:  15 (8 variable)
## initial  value 470.206060 
## iter  10 value 182.110957
## iter  20 value 151.537964
## iter  30 value 149.151242
## final  value 148.798933 
## converged</code></pre>
<pre class="r"><code>anova(mod1,mod2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Model"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Resid. df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Test"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["   Df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["LR stat."],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Pr(Chi)"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"lcat5","2":"852","3":"309.9671","4":"","5":"NA","6":"NA","7":"NA"},{"1":"lcat5 * year","2":"848","3":"297.5979","4":"1 vs 2","5":"4","6":"12.36923","7":"0.01480671"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Evidence generally supports that there is no significant difference between years at the
# overall level, but evidence suggests that a difference between years exists when 
# examining at the scale of individual watershed.



# What does it look like when data is combined among years ????

# Create new df for mean values &amp; labels;
# values not grouped by year

# create table of mean lengths/weights by season for each spp/river
dat2 &lt;- dat %&gt;%
  group_by(river,spp,sample.event.num,age) %&gt;%
  summarise(avg_wt = mean(wt_g),
            avg_len = mean(len_mm),
            n_wt = validn(wt_g),             # number of fish with weight data
            n_len = validn(len_mm),           # number of fish with length data
            n_diet = validn(sample.id)) %&gt;%   # number of fish diet sampled
  mutate(season = fct_recode(sample.event.num,         #code sampling events as seasons
                             &quot;Early Summer&quot;= &quot;1&quot;, 
                             &quot;Mid-Summer&quot; = &quot;2&quot;,
                             &quot;Late Summer&quot; = &quot;3&quot;,
                             &quot;Fall&quot; = &quot;4&quot;)) %&gt;%
  mutate(river_spp = paste(river,&quot;\n&quot;,spp)) %&gt;%
  mutate(count_label = paste0(&quot;n=&quot;,n_len)) %&gt;%
  ungroup() </code></pre>
</div>
</div>
<div id="create-mean-length-weight-values-for-fish-grouped-at-level-of" class="section level5">
<h5>Create mean length &amp; weight values for fish grouped at level of:</h5>
<ul>
<li>river</li>
<li>year</li>
<li>species</li>
<li>season (“sample event”)</li>
<li>age</li>
</ul>
<pre class="r"><code># create table of mean lengths/weights by season for each year/spp/river
dat1 &lt;- dat %&gt;%
  group_by(river,year,spp,sample.event.num,age) %&gt;%
  summarise(avg_wt = mean(wt_g),
            avg_len = mean(len_mm),
            n_wt = validn(wt_g),             # number of fish with weight data
            n_len = validn(len_mm),           # number of fish with length data
            n_diet = validn(sample.id)) %&gt;%   # number of fish diet sampled
  mutate(season = fct_recode(sample.event.num,         #code sampling events as seasons
                             &quot;Early Summer&quot;= &quot;1&quot;, 
                             &quot;Mid-Summer&quot; = &quot;2&quot;,
                             &quot;Late Summer&quot; = &quot;3&quot;,
                             &quot;Fall&quot; = &quot;4&quot;)) %&gt;%
  mutate(river_spp = paste(river,&quot;\n&quot;,spp)) %&gt;%
  mutate(count_label = paste0(&quot;n=&quot;,n_len)) %&gt;%
  ungroup() 
  # filter(n_wt &gt; 1) # not sure why I had this in original code</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="possible-other-avenue-to-modelcompare-growth-rates-create-vb-model-for-each-site-visitseason-plot" class="section level1">
<h1>Possible other avenue to model/compare growth rates: create VB model for each site visit/season; plot</h1>
<div id="plot-size-trends" class="section level4">
<h4>Plot size trends:</h4>
<ul>
<li>Coho
<ul>
<li>Fork Length</li>
<li>Weight</li>
</ul></li>
<li>Chinook
<ul>
<li>Fork Length</li>
<li>Weight</li>
</ul></li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
